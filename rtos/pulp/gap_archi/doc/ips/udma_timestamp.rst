.. 
   Input file: fe/ips/udma/fe/ips/udma/udma_timestamp/README.md

Register map
^^^^^^^^^^^^


Overview
""""""""


Refer to :ref:`GAP9 address map<REF_MEMORY_MAP_DETAIL>` for the base address to be used.

.. table:: 
    :align: center
    :widths: 40 12 12 90

    +---------------------------------------------------+------+-----+---------------------------------------------+
    |                       Name                        |Offset|Width|                 Description                 |
    +===================================================+======+=====+=============================================+
    |:ref:`REG_CMD<udma_timestamp__REG_CMD>`            |     0|   32|Counter start/stop/reset                     |
    +---------------------------------------------------+------+-----+---------------------------------------------+
    |:ref:`REG_SETUP_CNT<udma_timestamp__REG_SETUP_CNT>`|     4|   32|Configuration of counter start through GPIO  |
    +---------------------------------------------------+------+-----+---------------------------------------------+
    |:ref:`REG_SETUP_CH0<udma_timestamp__REG_SETUP_CH0>`|     8|   32|Channel 0 configuration (AUX or GPIOs events)|
    +---------------------------------------------------+------+-----+---------------------------------------------+
    |:ref:`REG_SETUP_CH1<udma_timestamp__REG_SETUP_CH1>`|    12|   32|Channel 1 configuration (AUX or GPIOs events)|
    +---------------------------------------------------+------+-----+---------------------------------------------+
    |:ref:`REG_SETUP_CH2<udma_timestamp__REG_SETUP_CH2>`|    16|   32|Channel 2 configuration (AUX or GPIOs events)|
    +---------------------------------------------------+------+-----+---------------------------------------------+
    |:ref:`REG_SETUP_CH3<udma_timestamp__REG_SETUP_CH3>`|    20|   32|Channel 3 configuration (AUX or GPIOs events)|
    +---------------------------------------------------+------+-----+---------------------------------------------+
    |:ref:`REG_SETUP_CH4<udma_timestamp__REG_SETUP_CH4>`|    24|   32|Channel 4 configuration (AUX or GPIOs events)|
    +---------------------------------------------------+------+-----+---------------------------------------------+
    |:ref:`REG_SETUP_CH5<udma_timestamp__REG_SETUP_CH5>`|    28|   32|Channel 5 configuration (AUX or GPIOs events)|
    +---------------------------------------------------+------+-----+---------------------------------------------+
    |:ref:`REG_SETUP_CH6<udma_timestamp__REG_SETUP_CH6>`|    32|   32|Channel 6 configuration (AUX or GPIOs events)|
    +---------------------------------------------------+------+-----+---------------------------------------------+
    |:ref:`REG_SETUP_CH7<udma_timestamp__REG_SETUP_CH7>`|    36|   32|Channel 7 configuration (AUX or GPIOs events)|
    +---------------------------------------------------+------+-----+---------------------------------------------+
    |:ref:`REG_EVENT<udma_timestamp__REG_EVENT>`        |    40|   32|SOC events timestamp configuration           |
    +---------------------------------------------------+------+-----+---------------------------------------------+
    |:ref:`REG_CLK_CFG<udma_timestamp__REG_CLK_CFG>`    |    44|   32|Counting clock configuration                 |
    +---------------------------------------------------+------+-----+---------------------------------------------+

.. _udma_timestamp__REG_CMD:

REG_CMD
"""""""

Counter start/stop/reset

.. table:: 
    :align: center
    :widths: 13 12 45 24 85

    +-----+---+--------+-----+------------------------------------------------------+
    |Bit #|R/W|  Name  |Reset|                     Description                      |
    +=====+===+========+=====+======================================================+
    |    0|W  |CNT_CLR |0x0  |Write 1 to reset the counter to 0 and start/restart it|
    +-----+---+--------+-----+------------------------------------------------------+
    |    1|W  |CNT_STOP|0x0  |Write 1 to reset the counter to 0 and stop it         |
    +-----+---+--------+-----+------------------------------------------------------+

.. _udma_timestamp__REG_SETUP_CNT:

REG_SETUP_CNT
"""""""""""""

Configuration of counter start through GPIO

.. table:: 
    :align: center
    :widths: 13 12 45 24 85

    +-----+---+--------+-----+---------------------------------------------------------------------------------------------------------+
    |Bit #|R/W|  Name  |Reset|                                               Description                                               |
    +=====+===+========+=====+=========================================================================================================+
    |5:0  |R/W|EXT_SEL |0x00 |ID of the GPIO used to start/restart the counter                                                         |
    +-----+---+--------+-----+---------------------------------------------------------------------------------------------------------+
    |7:6  |R/W|EXT_TYPE|0x0  |GPIO condition to trigger counter start/restart: 0: rising edge; 1: falling edge; 2: both edges; 3: never|
    +-----+---+--------+-----+---------------------------------------------------------------------------------------------------------+
    |8    |R/W|EXT_EN  |0x0  |If 1, GPIO-controlled start/restart of the counter is activated                                          |
    +-----+---+--------+-----+---------------------------------------------------------------------------------------------------------+

.. _udma_timestamp__REG_SETUP_CH0:

REG_SETUP_CH0
"""""""""""""

Channel 0 configuration (AUX or GPIOs events)

.. table:: 
    :align: center
    :widths: 13 12 45 24 85

    +-----+---+----------+-----+------------------------------------------------------------------------------------------------------------------------------------------------+
    |Bit #|R/W|   Name   |Reset|                                                                  Description                                                                   |
    +=====+===+==========+=====+================================================================================================================================================+
    |5:0  |R/W|INPUT_SEL |0x00 |Select event input index for channel 0, depending on INPUT_TYPE: 0 to 63 for GPIOs, 0 to 7 for SFU events, 8 to 10 for WS signal of SAI0 to SAI2|
    +-----+---+----------+-----+------------------------------------------------------------------------------------------------------------------------------------------------+
    |7:6  |R/W|INPUT_TYPE|0x0  |Event source for channel 0: 0: GPIO rising edge; 1: GPIO falling edge; 2: GPIO both edges; 3: AUX event (SFU or SAI WS)                         |
    +-----+---+----------+-----+------------------------------------------------------------------------------------------------------------------------------------------------+
    |8    |R/W|INPUT_EN  |0x0  |Enable timestamping for channel 0                                                                                                               |
    +-----+---+----------+-----+------------------------------------------------------------------------------------------------------------------------------------------------+
    |23:16|R/W|DEST_ID   |0x00 |UDMA destination ID for channel 0                                                                                                               |
    +-----+---+----------+-----+------------------------------------------------------------------------------------------------------------------------------------------------+

.. _udma_timestamp__REG_SETUP_CH1:

REG_SETUP_CH1
"""""""""""""

Channel 1 configuration (AUX or GPIOs events)

.. table:: 
    :align: center
    :widths: 13 12 45 24 85

    +-----+---+----------+-----+------------------------------------------------------------------------------------------------------------------------------------------------+
    |Bit #|R/W|   Name   |Reset|                                                                  Description                                                                   |
    +=====+===+==========+=====+================================================================================================================================================+
    |5:0  |R/W|INPUT_SEL |0x00 |Select event input index for channel 1, depending on INPUT_TYPE: 0 to 63 for GPIOs, 0 to 7 for SFU events, 8 to 10 for WS signal of SAI0 to SAI2|
    +-----+---+----------+-----+------------------------------------------------------------------------------------------------------------------------------------------------+
    |7:6  |R/W|INPUT_TYPE|0x0  |Event source for channel 1: 0: GPIO rising edge; 1: GPIO falling edge; 2: GPIO both edges; 3: AUX event (SFU or SAI WS)                         |
    +-----+---+----------+-----+------------------------------------------------------------------------------------------------------------------------------------------------+
    |8    |R/W|INPUT_EN  |0x0  |Enable timestamping for channel 1                                                                                                               |
    +-----+---+----------+-----+------------------------------------------------------------------------------------------------------------------------------------------------+
    |23:16|R/W|DEST_ID   |0x00 |UDMA destination ID for channel 1                                                                                                               |
    +-----+---+----------+-----+------------------------------------------------------------------------------------------------------------------------------------------------+

.. _udma_timestamp__REG_SETUP_CH2:

REG_SETUP_CH2
"""""""""""""

Channel 2 configuration (AUX or GPIOs events)

.. table:: 
    :align: center
    :widths: 13 12 45 24 85

    +-----+---+----------+-----+------------------------------------------------------------------------------------------------------------------------------------------------+
    |Bit #|R/W|   Name   |Reset|                                                                  Description                                                                   |
    +=====+===+==========+=====+================================================================================================================================================+
    |5:0  |R/W|INPUT_SEL |0x00 |Select event input index for channel 2, depending on INPUT_TYPE: 0 to 63 for GPIOs, 0 to 7 for SFU events, 8 to 10 for WS signal of SAI0 to SAI2|
    +-----+---+----------+-----+------------------------------------------------------------------------------------------------------------------------------------------------+
    |7:6  |R/W|INPUT_TYPE|0x0  |Event source for channel 2: 0: GPIO rising edge; 1: GPIO falling edge; 2: GPIO both edges; 3: AUX event (SFU or SAI WS)                         |
    +-----+---+----------+-----+------------------------------------------------------------------------------------------------------------------------------------------------+
    |8    |R/W|INPUT_EN  |0x0  |Enable timestamping for channel 2                                                                                                               |
    +-----+---+----------+-----+------------------------------------------------------------------------------------------------------------------------------------------------+
    |23:16|R/W|DEST_ID   |0x00 |UDMA destination ID for channel 2                                                                                                               |
    +-----+---+----------+-----+------------------------------------------------------------------------------------------------------------------------------------------------+

.. _udma_timestamp__REG_SETUP_CH3:

REG_SETUP_CH3
"""""""""""""

Channel 3 configuration (AUX or GPIOs events)

.. table:: 
    :align: center
    :widths: 13 12 45 24 85

    +-----+---+----------+-----+------------------------------------------------------------------------------------------------------------------------------------------------+
    |Bit #|R/W|   Name   |Reset|                                                                  Description                                                                   |
    +=====+===+==========+=====+================================================================================================================================================+
    |5:0  |R/W|INPUT_SEL |0x00 |Select event input index for channel 3, depending on INPUT_TYPE: 0 to 63 for GPIOs, 0 to 7 for SFU events, 8 to 10 for WS signal of SAI0 to SAI2|
    +-----+---+----------+-----+------------------------------------------------------------------------------------------------------------------------------------------------+
    |7:6  |R/W|INPUT_TYPE|0x0  |Event source for channel 3: 0: GPIO rising edge; 1: GPIO falling edge; 2: GPIO both edges; 3: AUX event (SFU or SAI WS)                         |
    +-----+---+----------+-----+------------------------------------------------------------------------------------------------------------------------------------------------+
    |8    |R/W|INPUT_EN  |0x0  |Enable timestamping for channel 3                                                                                                               |
    +-----+---+----------+-----+------------------------------------------------------------------------------------------------------------------------------------------------+
    |23:16|R/W|DEST_ID   |0x00 |UDMA destination ID for channel 3                                                                                                               |
    +-----+---+----------+-----+------------------------------------------------------------------------------------------------------------------------------------------------+

.. _udma_timestamp__REG_SETUP_CH4:

REG_SETUP_CH4
"""""""""""""

Channel 4 configuration (AUX or GPIOs events)

.. table:: 
    :align: center
    :widths: 13 12 45 24 85

    +-----+---+----------+-----+------------------------------------------------------------------------------------------------------------------------------------------------+
    |Bit #|R/W|   Name   |Reset|                                                                  Description                                                                   |
    +=====+===+==========+=====+================================================================================================================================================+
    |5:0  |R/W|INPUT_SEL |0x00 |Select event input index for channel 4, depending on INPUT_TYPE: 0 to 63 for GPIOs, 0 to 7 for SFU events, 8 to 10 for WS signal of SAI0 to SAI2|
    +-----+---+----------+-----+------------------------------------------------------------------------------------------------------------------------------------------------+
    |7:6  |R/W|INPUT_TYPE|0x0  |Event source for channel 4: 0: GPIO rising edge; 1: GPIO falling edge; 2: GPIO both edges; 3: AUX event (SFU or SAI WS)                         |
    +-----+---+----------+-----+------------------------------------------------------------------------------------------------------------------------------------------------+
    |8    |R/W|INPUT_EN  |0x0  |Enable timestamping for channel 4                                                                                                               |
    +-----+---+----------+-----+------------------------------------------------------------------------------------------------------------------------------------------------+
    |23:16|R/W|DEST_ID   |0x00 |UDMA destination ID for channel 4                                                                                                               |
    +-----+---+----------+-----+------------------------------------------------------------------------------------------------------------------------------------------------+

.. _udma_timestamp__REG_SETUP_CH5:

REG_SETUP_CH5
"""""""""""""

Channel 5 configuration (AUX or GPIOs events)

.. table:: 
    :align: center
    :widths: 13 12 45 24 85

    +-----+---+----------+-----+------------------------------------------------------------------------------------------------------------------------------------------------+
    |Bit #|R/W|   Name   |Reset|                                                                  Description                                                                   |
    +=====+===+==========+=====+================================================================================================================================================+
    |5:0  |R/W|INPUT_SEL |0x00 |Select event input index for channel 5, depending on INPUT_TYPE: 0 to 63 for GPIOs, 0 to 7 for SFU events, 8 to 10 for WS signal of SAI0 to SAI2|
    +-----+---+----------+-----+------------------------------------------------------------------------------------------------------------------------------------------------+
    |7:6  |R/W|INPUT_TYPE|0x0  |Event source for channel 5: 0: GPIO rising edge; 1: GPIO falling edge; 2: GPIO both edges; 3: AUX event (SFU or SAI WS)                         |
    +-----+---+----------+-----+------------------------------------------------------------------------------------------------------------------------------------------------+
    |8    |R/W|INPUT_EN  |0x0  |Enable timestamping for channel 5                                                                                                               |
    +-----+---+----------+-----+------------------------------------------------------------------------------------------------------------------------------------------------+
    |23:16|R/W|DEST_ID   |0x00 |UDMA destination ID for channel 5                                                                                                               |
    +-----+---+----------+-----+------------------------------------------------------------------------------------------------------------------------------------------------+

.. _udma_timestamp__REG_SETUP_CH6:

REG_SETUP_CH6
"""""""""""""

Channel 6 configuration (AUX or GPIOs events)

.. table:: 
    :align: center
    :widths: 13 12 45 24 85

    +-----+---+----------+-----+------------------------------------------------------------------------------------------------------------------------------------------------+
    |Bit #|R/W|   Name   |Reset|                                                                  Description                                                                   |
    +=====+===+==========+=====+================================================================================================================================================+
    |5:0  |R/W|INPUT_SEL |0x00 |Select event input index for channel 6, depending on INPUT_TYPE: 0 to 63 for GPIOs, 0 to 7 for SFU events, 8 to 10 for WS signal of SAI0 to SAI2|
    +-----+---+----------+-----+------------------------------------------------------------------------------------------------------------------------------------------------+
    |7:6  |R/W|INPUT_TYPE|0x0  |Event source for channel 6: 0: GPIO rising edge; 1: GPIO falling edge; 2: GPIO both edges; 3: AUX event (SFU or SAI WS)                         |
    +-----+---+----------+-----+------------------------------------------------------------------------------------------------------------------------------------------------+
    |8    |R/W|INPUT_EN  |0x0  |Enable timestamping for channel 6                                                                                                               |
    +-----+---+----------+-----+------------------------------------------------------------------------------------------------------------------------------------------------+
    |23:16|R/W|DEST_ID   |0x00 |UDMA destination ID for channel 6                                                                                                               |
    +-----+---+----------+-----+------------------------------------------------------------------------------------------------------------------------------------------------+

.. _udma_timestamp__REG_SETUP_CH7:

REG_SETUP_CH7
"""""""""""""

Channel 7 configuration (AUX or GPIOs events)

.. table:: 
    :align: center
    :widths: 13 12 45 24 85

    +-----+---+----------+-----+------------------------------------------------------------------------------------------------------------------------------------------------+
    |Bit #|R/W|   Name   |Reset|                                                                  Description                                                                   |
    +=====+===+==========+=====+================================================================================================================================================+
    |5:0  |R/W|INPUT_SEL |0x00 |Select event input index for channel 7, depending on INPUT_TYPE: 0 to 63 for GPIOs, 0 to 7 for SFU events, 8 to 10 for WS signal of SAI0 to SAI2|
    +-----+---+----------+-----+------------------------------------------------------------------------------------------------------------------------------------------------+
    |7:6  |R/W|INPUT_TYPE|0x0  |Event source for channel 7: 0: GPIO rising edge; 1: GPIO falling edge; 2: GPIO both edges; 3: AUX event (SFU or SAI WS)                         |
    +-----+---+----------+-----+------------------------------------------------------------------------------------------------------------------------------------------------+
    |8    |R/W|INPUT_EN  |0x0  |Enable timestamping for channel 7                                                                                                               |
    +-----+---+----------+-----+------------------------------------------------------------------------------------------------------------------------------------------------+
    |23:16|R/W|DEST_ID   |0x00 |UDMA destination ID for channel 7                                                                                                               |
    +-----+---+----------+-----+------------------------------------------------------------------------------------------------------------------------------------------------+

.. _udma_timestamp__REG_EVENT:

REG_EVENT
"""""""""

SOC events timestamp configuration

.. table:: 
    :align: center
    :widths: 13 12 45 24 85

    +-----+---+-------------+-----+-----------------------------------+
    |Bit #|R/W|    Name     |Reset|            Description            |
    +=====+===+=============+=====+===================================+
    |7:0  |R/W|DEST_ID_EVT_0|0xFF |UDMA destination ID for SOC event 0|
    +-----+---+-------------+-----+-----------------------------------+
    |15:8 |R/W|DEST_ID_EVT_1|0xFF |UDMA destination ID for SOC event 1|
    +-----+---+-------------+-----+-----------------------------------+
    |23:16|R/W|DEST_ID_EVT_2|0xFF |UDMA destination ID for SOC event 2|
    +-----+---+-------------+-----+-----------------------------------+
    |31:24|R/W|DEST_ID_EVT_3|0xFF |UDMA destination ID for SOC event 3|
    +-----+---+-------------+-----+-----------------------------------+

.. _udma_timestamp__REG_CLK_CFG:

REG_CLK_CFG
"""""""""""

Counting clock configuration

.. table:: 
    :align: center
    :widths: 13 12 45 24 85

    +-----+---+----------+-----+-------------------------------------------------------------+
    |Bit #|R/W|   Name   |Reset|                         Description                         |
    +=====+===+==========+=====+=============================================================+
    |1:0  |R/W|CLK_MUX   |0x0  |Select clock source: b00: PWM; b01: GPIO; b10: REF FAST clock|
    +-----+---+----------+-----+-------------------------------------------------------------+
    |2    |R/W|CLK_MUX_EN|0x0  |Enable the clock mux: if b0, internal SOC clock is used      |
    +-----+---+----------+-----+-------------------------------------------------------------+
    |6:4  |R/W|PWM_SEL   |0x0  |Select PWM clock source among the 8 possible PWM             |
    +-----+---+----------+-----+-------------------------------------------------------------+
    |13:8 |R/W|GPIO_SEL  |0x0  |Select GPIO clock source among the 64 possible GPIOs         |
    +-----+---+----------+-----+-------------------------------------------------------------+
    |23:16|R/W|PRESCALER |0x0  |Clock counter prescaler                                      |
    +-----+---+----------+-----+-------------------------------------------------------------+
