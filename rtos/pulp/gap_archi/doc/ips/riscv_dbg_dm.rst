Input file: docs/IP_REFERENCES/RISCV_DBG_DM_reference.md

Register map
^^^^^^^^^^^^


Overview
""""""""

.. table:: 

    +------------------------------------------+------+-----+------------------------------------+
    |                   Name                   |Offset|Width|            Description             |
    +==========================================+======+=====+====================================+
    |:ref:`data0<riscv_dbg_dm_data0>`          |     4|   32|Abstract Data 0                     |
    +------------------------------------------+------+-----+------------------------------------+
    |:ref:`data1<riscv_dbg_dm_data1>`          |     5|   32|Abstract Data 1                     |
    +------------------------------------------+------+-----+------------------------------------+
    |:ref:`dmcontrol<riscv_dbg_dm_dmcontrol>`  |    16|   32|Debug Module Control                |
    +------------------------------------------+------+-----+------------------------------------+
    |:ref:`dmstatus<riscv_dbg_dm_dmstatus>`    |    17|   32|Debug Module Status                 |
    +------------------------------------------+------+-----+------------------------------------+
    |:ref:`hartinfo<riscv_dbg_dm_hartinfo>`    |    18|   32|Hart Info                           |
    +------------------------------------------+------+-----+------------------------------------+
    |:ref:`abstractcs<riscv_dbg_dm_abstractcs>`|    22|   32|Abstract Control and Status         |
    +------------------------------------------+------+-----+------------------------------------+
    |:ref:`command<riscv_dbg_dm_command>`      |    23|   32|Abstract Command                    |
    +------------------------------------------+------+-----+------------------------------------+
    |:ref:`sbcs<riscv_dbg_dm_sbcs>`            |    56|   32|System Bus Access Control and Status|
    +------------------------------------------+------+-----+------------------------------------+
    |:ref:`progbuf0<riscv_dbg_dm_progbuf0>`    |    32|   32|Program Buffer 0                    |
    +------------------------------------------+------+-----+------------------------------------+
    |:ref:`progbuf1<riscv_dbg_dm_progbuf1>`    |    33|   32|Program Buffer 1                    |
    +------------------------------------------+------+-----+------------------------------------+
    |:ref:`progbuf2<riscv_dbg_dm_progbuf2>`    |    34|   32|Program Buffer 2                    |
    +------------------------------------------+------+-----+------------------------------------+
    |:ref:`progbuf3<riscv_dbg_dm_progbuf3>`    |    35|   32|Program Buffer 3                    |
    +------------------------------------------+------+-----+------------------------------------+
    |:ref:`progbuf4<riscv_dbg_dm_progbuf4>`    |    36|   32|Program Buffer 4                    |
    +------------------------------------------+------+-----+------------------------------------+
    |:ref:`progbuf5<riscv_dbg_dm_progbuf5>`    |    37|   32|Program Buffer 5                    |
    +------------------------------------------+------+-----+------------------------------------+
    |:ref:`progbuf6<riscv_dbg_dm_progbuf6>`    |    38|   32|Program Buffer 6                    |
    +------------------------------------------+------+-----+------------------------------------+
    |:ref:`progbuf7<riscv_dbg_dm_progbuf7>`    |    39|   32|Program Buffer 7                    |
    +------------------------------------------+------+-----+------------------------------------+
    |:ref:`sbaddress0<riscv_dbg_dm_sbaddress0>`|    57|   32|System Bus Address 31:0             |
    +------------------------------------------+------+-----+------------------------------------+
    |:ref:`dmcs2<riscv_dbg_dm_dmcs2>`          |    50|   32|Debug Module Control and Status 2   |
    +------------------------------------------+------+-----+------------------------------------+
    |:ref:`sbdata0<riscv_dbg_dm_sbdata0>`      |    60|   32|System Bus data 31:0                |
    +------------------------------------------+------+-----+------------------------------------+

.. _riscv_dbg_dm_data0:

data0
"""""

Abstract Data 0

.. table:: 

    +-----+---+----+-----------+
    |Bit #|R/W|Name|Description|
    +=====+===+====+===========+
    |31:0 |R/W|data|Data value |
    +-----+---+----+-----------+

.. _riscv_dbg_dm_data1:

data1
"""""

Abstract Data 1

.. table:: 

    +-----+---+----+-----------+
    |Bit #|R/W|Name|Description|
    +=====+===+====+===========+
    |31:0 |R/W|data|Data value |
    +-----+---+----+-----------+

.. _riscv_dbg_dm_dmcontrol:

dmcontrol
"""""""""

Debug Module Control

.. table:: 

    +-----+---+---------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    |Bit #|R/W|     Name      |                                                                                                                                                                                                                                                                                                                                                                      Description                                                                                                                                                                                                                                                                                                                                                                      |
    +=====+===+===============+=======================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
    |    0|R/W|dmactive       |This  bit  serves  as  a  reset  signal  for  the  DebugModule itself.0:  The  module’s  state,  including  authenticationmechanism, takes its reset values (thedmactivebitis the only bit which can be written to somethingother than its reset value).1:  The module functions normally.No other mechanism should exist that may resultin  resetting  the  Debug  Module  after  power  up,with the possible (but not recommended) excep-tion of a global reset signal that resets the entireplatform.A debugger may pulse this bit low to get the De-bug Module into a known state.Implementations may pay attention to this bit tofurther aid debugging, for example by preventingthe Debug Module from being power gated whiledebugging is active.|
    +-----+---+---------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    |    1|R/W|ndmreset       |This bit controls the reset signal from the DM tothe  rest  of  the  system.   The  signal  should  resetevery  part  of  the  system,  including  every  hart,except for the DM and any logic required to accessthe DM. To perform a system reset the debuggerwrites 1, and then writes 0 to deassert the reset.                                                                                                                                                                                                                                                                                                                                                                                                                                      |
    +-----+---+---------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    |    2|R/W|clrresethaltreq|This optional field clears the halt-on-reset requestbit for all currently selected harts.Writes apply to the new value ofhartselandhasel.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
    +-----+---+---------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    |    3|R/W|setresethaltreq|This  optional  field  writes  the  halt-on-reset  re-quest  bit  for  all  currently  selected  harts,  unlessclrresethaltreqis  simultaneously  set  to  1.   Whenset to 1, each selected hart will halt upon the nextdeassertion of its reset.  The halt-on-reset requestbit  is  not  automatically  cleared.   The  debuggermust write toclrresethaltreqto clear it.Writes apply to the new value ofhartselandhasel.Ifhasresethaltreqis  0,  this  field  is  not  imple-mented.                                                                                                                                                                                                                                                                  |
    +-----+---+---------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    |15:6 |R/W|hartselhi      |The high 10 bits ofhartsel:  the DM-specific indexof the hart to select.  This hart is always part ofthe currently selected harts.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
    +-----+---+---------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    |25:16|R/W|hartsello      |The low 10 bits ofhartsel:  the DM-specific indexof the hart to select.  This hart is always part ofthe currently selected harts.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
    +-----+---+---------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    |   26|R/W|hasel          |Selects the definition of currently selected harts.0:  There is a single currently selected hart, thatis selected byhartsel.1:  There may be multiple currently selected harts– the hart selected byhartsel, plus those selectedby the hart array mask register.An implementation which does not implement thehart array mask register must tie this field to 0.A  debugger  which  wishes  to  use  the  hart  arraymask register feature should set this bit and readback to see if the functionality is supported.                                                                                                                                                                                                                                  |
    +-----+---+---------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    |   28|R/W|ackhavereset   |0:  No effect.1:  Clearshaveresetfor any selected harts.Writes apply to the new value ofhartselandhasel.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
    +-----+---+---------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    |   29|R/W|hartreset      |This optional field writes the reset bit for all thecurrently selected harts.  To perform a reset thedebugger writes 1, and then writes 0 to deassertthe reset signal.While this bit is 1, the debugger must not changewhich harts are selected.If this feature is not implemented, the bit alwaysstays 0, so after writing 1 the debugger can readthe register back to see if the feature is supported.Writes apply to the new value ofhartselandhasel.                                                                                                                                                                                                                                                                                               |
    +-----+---+---------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    |   30|R/W|resumereq      |Writing  1  causes  the  currently  selected  harts  toresume  once,  if  they  are  halted  when  the  writeoccurs.  It also clears the resume ack bit for thoseharts.resumereqis ignored ifhaltreqis set.Writes apply to the new value ofhartselandhasel.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
    +-----+---+---------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    |   31|R/W|haltreq        |Writing 0 clears the halt request bit for all cur-rently selected harts.  This may cancel outstand-ing halt requests for those harts.Writing 1 sets the halt request bit for all currentlyselected harts.  Running harts will halt whenevertheir halt request bit is set.Writes apply to the new value ofhartselandhasel.                                                                                                                                                                                                                                                                                                                                                                                                                              |
    +-----+---+---------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

.. _riscv_dbg_dm_dmstatus:

dmstatus
""""""""

Debug Module Status

.. table:: 

    +-----+---+---------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    |Bit #|R/W|     Name      |                                                                                                                                            Description                                                                                                                                            |
    +=====+===+===============+===================================================================================================================================================================================================================================================================================================+
    |3:0  |R  |version        |0:  There is no Debug Module present.1:  There is a Debug Module and it conforms toversion 0.11 of this specification.2:  There is a Debug Module and it conforms toversion 0.13 of this specification.15:  There is a Debug Module but it does not con-form to any available version of this spec.|
    +-----+---+---------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    |4    |R  |confstrptrvalid|0:confstrptr0–confstrptr3hold  informationwhich is not relevant to the configuration string.1:confstrptr0–confstrptr3hold  the  addressof the configuration string.                                                                                                                                |
    +-----+---+---------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    |5    |R  |hasresethaltreq|1  if  this  Debug  Module  supports  halt-on-resetfunctionality  controllable  by  thesetresethaltreqandclrresethaltreqbits.  0 otherwise.                                                                                                                                                        |
    +-----+---+---------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    |6    |R  |authbusy       |0:  The authentication module is ready to processthe next read/write toauthdata.1:  The authentication module is busy.  Accessingauthdataresults in unspecified behavior.authbusyonly becomes set in immediate responseto an access toauthdata.                                                    |
    +-----+---+---------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    |7    |R  |authenticated  |0:   Authentication  is  required  before  using  theDM.1:  The authentication check has passed.On components that don’t implement authentica-tion, this bit must be preset as 1.                                                                                                                  |
    +-----+---+---------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    |8    |R  |anyhalted      |This field is 1 when any currently selected hart ishalted.                                                                                                                                                                                                                                         |
    +-----+---+---------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    |9    |R  |allhalted      |This  field  is  1  when  all  currently  selected  hartsare halted.                                                                                                                                                                                                                               |
    +-----+---+---------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    |10   |R  |anyrunning     |This field is 1 when any currently selected hart isrunning.                                                                                                                                                                                                                                        |
    +-----+---+---------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    |11   |R  |allrunning     |This  field  is  1  when  all  currently  selected  hartsare running.                                                                                                                                                                                                                              |
    +-----+---+---------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    |12   |R  |anyunavail     |This field is 1 when any currently selected hart isunavailable.                                                                                                                                                                                                                                    |
    +-----+---+---------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    |13   |R  |allunavail     |This  field  is  1  when  all  currently  selected  hartsare unavailable.                                                                                                                                                                                                                          |
    +-----+---+---------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    |14   |R  |anynonexistent |This  field  is  1  when  any  currently  selected  hartdoes not exist in this platform.                                                                                                                                                                                                           |
    +-----+---+---------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    |15   |R  |allnonexistent |This field is 1 when all currently selected harts donot exist in this platform.                                                                                                                                                                                                                    |
    +-----+---+---------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    |16   |R  |anyresumeack   |This  field  is  1  when  any  currently  selected  harthas acknowledged its last resume request.                                                                                                                                                                                                  |
    +-----+---+---------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    |17   |R  |allresumeack   |This  field  is  1  when  all  currently  selected  hartshave acknowledged their last resume request.                                                                                                                                                                                              |
    +-----+---+---------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    |18   |R  |anyhavereset   |This field is 1 when at least one currently selectedhart  has  been  reset  and  reset  has  not  been  ac-knowledged for that hart.                                                                                                                                                               |
    +-----+---+---------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    |19   |R  |allhavereset   |This  field  is  1  when  all  currently  selected  hartshave been reset and reset has not been acknowl-edged for any of them.                                                                                                                                                                     |
    +-----+---+---------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    |22   |R  |impebreak      |If 1, then there is an implicitebreakinstructionat  the  non-existent  word  immediately  after  theProgram  Buffer.   This  saves  the  debugger  fromhaving to write theebreakitself, and allows theProgram Buffer to be one word smaller.This must be 1 whenprogbufsizeis 1.                    |
    +-----+---+---------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

.. _riscv_dbg_dm_hartinfo:

hartinfo
""""""""

Hart Info

.. table:: 

    +-----+---+----------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    |Bit #|R/W|   Name   |                                                                                                                                  Description                                                                                                                                   |
    +=====+===+==========+================================================================================================================================================================================================================================================================================+
    |11:0 |R  |dataaddr  |Ifdataaccessis  0:  The number of  the  first  CSRdedicated to shadowing thedataregisters.Ifdataaccessis 1:  Signed address of RAM wherethedataregisters  are  shadowed,  to  be  used  toaccess relative tozero.                                                               |
    +-----+---+----------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    |15:12|R  |datasize  |Ifdataaccessis 0:  Number of CSRs dedicated toshadowing thedataregisters.Ifdataaccessis 1:  Number of 32-bit words in thememory  map  dedicated  to  shadowing  thedataregisters.Since  there  are  at  most  12dataregisters,  thevalue in this register must be 12 or smaller.|
    +-----+---+----------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    |16   |R  |dataaccess|0:  Thedataregisters  are  shadowed  in  the  hartby CSRs.  Each CSR is DXLEN bits in size, andcorresponds to a single argument, per Table 3.1.1:  Thedataregisters are shadowed in the hart’smemory map.  Each register takes up 4 bytes inthe memory map.                     |
    +-----+---+----------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    |23:20|R  |nscratch  |Number  ofdscratchregisters  available  for  thedebugger to use during program buffer execution,starting fromdscratch0. The debugger can makeno assumptions about the contents of these regis-ters between commands.                                                            |
    +-----+---+----------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

.. _riscv_dbg_dm_abstractcs:

abstractcs
""""""""""

Abstract Control and Status

.. table:: 

    +-----+---+-----------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    |Bit #|R/W|   Name    |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
    +=====+===+===========+=========================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
    |3:0  |R  |datacount  |Number  ofdataregisters  that  are  implementedas part of the abstract command interface.  Validsizes are 1 – 12.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
    +-----+---+-----------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    |10:8 |R/W|cmderr     |Gets set if an abstract command fails.  The bits inthis field remain set until they are cleared by writ-ing 1 to them.  No abstract command is starteduntil the value is reset to 0.This field only contains a valid value ifbusyis 0.0 (none):  No error.1  (busy):   An  abstract  command  was  executingwhilecommand,abstractcs,  orabstractautowas written, or when one of thedataorprogbufregisters was read or written.  This status is onlywritten ifcmderrcontains 0.2 (not supported): The requested command is notsupported, regardless of whether the hart is run-ning or not.3  (exception):  An  exception  occurred  while  ex-ecuting  the  command  (e.g.  while  executing  theProgram Buffer).4 (halt/resume):  The abstract command couldn’texecute  because  the  hart  wasn’t  in  the  requiredstate (running/halted), or unavailable.5  (bus):  The  abstract  command  failed  due  to  abus error (e.g. alignment, access size, or timeout).7 (other):  The command failed for another rea-son.|
    +-----+---+-----------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    |12   |R  |busy       |1:  An abstract command is currently being exe-cuted.This bit is set as soon ascommandis written, andis not cleared until that command has completed.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
    +-----+---+-----------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    |28:24|R  |progbufsize|Size of the Program Buffer, in 32-bit words.  Validsizes are 0 - 16.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
    +-----+---+-----------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

.. _riscv_dbg_dm_command:

command
"""""""

Abstract Command

.. table:: 

    +-----+---+-------+-------------------------------------------------------------------------------------------------+
    |Bit #|R/W| Name  |                                           Description                                           |
    +=====+===+=======+=================================================================================================+
    |23:0 |R/W|control|This  field  is  interpreted  in  a  command-specificmanner, described for each abstract command.|
    +-----+---+-------+-------------------------------------------------------------------------------------------------+
    |31:24|R/W|cmdtype|The type determines the overall functionality ofthis abstract command.                           |
    +-----+---+-------+-------------------------------------------------------------------------------------------------+

.. _riscv_dbg_dm_sbcs:

sbcs
""""

System Bus Access Control and Status

.. table:: 

    +-----+---+---------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    |Bit #|R/W|     Name      |                                                                                                                                                                                                                                                          Description                                                                                                                                                                                                                                                          |
    +=====+===+===============+===============================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
    |    0|R  |sbaccess8      |1 when 8-bit system bus accesses are supported.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
    +-----+---+---------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    |    1|R  |sbaccess16     |1 when 16-bit system bus accesses are supported.                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
    +-----+---+---------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    |    2|R  |sbaccess32     |1 when 32-bit system bus accesses are supported.                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
    +-----+---+---------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    |    3|R  |sbaccess64     |1 when 64-bit system bus accesses are supported.                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
    +-----+---+---------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    |    4|R  |sbaccess128    |1 when 128-bit system bus accesses are supported.                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
    +-----+---+---------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    |11:5 |R  |sbasize        |Width  of  system  bus  addresses  in  bits.   (0  indi-cates there is no bus access support.)                                                                                                                                                                                                                                                                                                                                                                                                                                 |
    +-----+---+---------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    |14:12|R/W|sberror        |When the Debug Module’s system bus master en-counters an error, this field gets set.  The bits inthis field remain set until they are cleared by writ-ing  1  to  them.   While  this  field  is  non-zero,  nomore system bus accesses can be initiated by theDebug Module.An  implementation  may  report  “Other”  (7)  forany error condition.0:  There was no bus error.1:  There was a timeout.2:  A bad address was accessed.3:  There was an alignment error.4:  An access of unsupported size was requested.7:  Other.|
    +-----+---+---------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    |   15|R/W|sbreadondata   |When 1, every read fromsbdata0automaticallytriggers a system bus read at the (possibly auto-incremented) address.                                                                                                                                                                                                                                                                                                                                                                                                              |
    +-----+---+---------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    |   16|R/W|sbautoincrement|When 1,sbaddressis incremented by the accesssize (in bytes) selected insbaccessafter every sys-tem bus access.                                                                                                                                                                                                                                                                                                                                                                                                                 |
    +-----+---+---------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    |19:17|R/W|sbaccess       |Select  the  access  size  to  use  for  system  bus  ac-cesses.0:  8-bit1:  16-bit2:  32-bit3:  64-bit4:  128-bitIfsbaccesshas  an  unsupported  value  when  theDM  starts  a  bus  access,  the  access  is  not  per-formed andsberroris set to 4.                                                                                                                                                                                                                                                                         |
    +-----+---+---------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    |   20|R/W|sbreadonaddr   |When 1, every write tosbaddress0automaticallytriggers a system bus read at the new address.                                                                                                                                                                                                                                                                                                                                                                                                                                    |
    +-----+---+---------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    |   21|R  |sbbusy         |When 1, indicates the system bus master is busy.(Whether the system bus itself is busy is related,but not the same thing.)  This bit goes high im-mediately  when  a  read  or  write  is  requested  forany reason, and does not go low until the accessis fully completed.Writes tosbcswhilesbbusyis high result in un-defined behavior.  A debugger must not write tosbcsuntil it readssbbusyas 0.                                                                                                                          |
    +-----+---+---------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    |27:22|R/W|sbbusyerror    |Set  when  the  debugger  attempts  to  read  datawhile  a  read  is  in  progress,  or  when  the  debug-ger initiates a new access while one is already inprogress (whilesbbusyis set).  It remains set untilit’s explicitly cleared by the debugger.While this field is set, no more system bus accessescan be initiated by the Debug Module.                                                                                                                                                                               |
    +-----+---+---------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    |31:29|R  |sbversion      |0: The System Bus interface conforms to mainlinedrafts of this spec older than 1 January, 2018.1: The System Bus interface conforms to this ver-sion of the spec.Other values are reserved for future versions.                                                                                                                                                                                                                                                                                                                |
    +-----+---+---------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

.. _riscv_dbg_dm_progbuf0:

progbuf0
""""""""

Program Buffer 0

.. table:: 

    +-----+---+----+-----------+
    |Bit #|R/W|Name|Description|
    +=====+===+====+===========+
    |31:0 |R/W|data|Data value |
    +-----+---+----+-----------+

.. _riscv_dbg_dm_progbuf1:

progbuf1
""""""""

Program Buffer 1

.. table:: 

    +-----+---+----+-----------+
    |Bit #|R/W|Name|Description|
    +=====+===+====+===========+
    |31:0 |R/W|data|Data value |
    +-----+---+----+-----------+

.. _riscv_dbg_dm_progbuf2:

progbuf2
""""""""

Program Buffer 2

.. table:: 

    +-----+---+----+-----------+
    |Bit #|R/W|Name|Description|
    +=====+===+====+===========+
    |31:0 |R/W|data|Data value |
    +-----+---+----+-----------+

.. _riscv_dbg_dm_progbuf3:

progbuf3
""""""""

Program Buffer 3

.. table:: 

    +-----+---+----+-----------+
    |Bit #|R/W|Name|Description|
    +=====+===+====+===========+
    |31:0 |R/W|data|Data value |
    +-----+---+----+-----------+

.. _riscv_dbg_dm_progbuf4:

progbuf4
""""""""

Program Buffer 4

.. table:: 

    +-----+---+----+-----------+
    |Bit #|R/W|Name|Description|
    +=====+===+====+===========+
    |31:0 |R/W|data|Data value |
    +-----+---+----+-----------+

.. _riscv_dbg_dm_progbuf5:

progbuf5
""""""""

Program Buffer 5

.. table:: 

    +-----+---+----+-----------+
    |Bit #|R/W|Name|Description|
    +=====+===+====+===========+
    |31:0 |R/W|data|Data value |
    +-----+---+----+-----------+

.. _riscv_dbg_dm_progbuf6:

progbuf6
""""""""

Program Buffer 6

.. table:: 

    +-----+---+----+-----------+
    |Bit #|R/W|Name|Description|
    +=====+===+====+===========+
    |31:0 |R/W|data|Data value |
    +-----+---+----+-----------+

.. _riscv_dbg_dm_progbuf7:

progbuf7
""""""""

Program Buffer 7

.. table:: 

    +-----+---+----+-----------+
    |Bit #|R/W|Name|Description|
    +=====+===+====+===========+
    |31:0 |R/W|data|Data value |
    +-----+---+----+-----------+

.. _riscv_dbg_dm_sbaddress0:

sbaddress0
""""""""""

System Bus Address 31:0

.. table:: 

    +-----+---+-------+-----------+
    |Bit #|R/W| Name  |Description|
    +=====+===+=======+===========+
    |31:0 |R/W|address|Address    |
    +-----+---+-------+-----------+

.. _riscv_dbg_dm_dmcs2:

dmcs2
"""""

Debug Module Control and Status 2

.. table:: 

    +-----+---+------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    |Bit #|R/W|    Name    |                                                                                                                                                                                                                                                                       Description                                                                                                                                                                                                                                                                        |
    +=====+===+============+==========================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
    |    0|R/W|hgselect    |0:  Operate on harts.1:  Operate on DM external triggers.If  there  are  no  DM  external  triggers,  this  fieldmust be tied to 0.                                                                                                                                                                                                                                                                                                                                                                                                                       |
    +-----+---+------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    |    1|R/W|hgwrite     |Whenhgselectis 0, writing 1 changes the groupof all selected harts to the value written togroup.When 1 is written andhgselectis 0, for every se-lected hart the DM will change its group to thevalue written togroup, if the hardware supportsthat group for that hart.When  1  is  written  andhgselectis  1,  the  DMwill  change  the  group  of  the  DM  external  trig-ger selected bydmexttriggerto the value writtentogroup, if the hardware supports that group forthat trigger.Writing 0 has no effect.                                         |
    +-----+---+------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    |6:2  |R/W|group       |Whenhgselectis 0, contains the group of the hartspecified byhartsel.Whenhgselectis 1, contains the group of the DMexternal trigger selected bydmexttrigger.Writes only have an effect ifhgwriteis also written1.Group  numbers  are  contiguous  starting  at  0,with  the  highest  number  being  implementation-dependent, and possibly different between differ-ent group types.  Debuggers should read back thisfield after writing to confirm they are using a hartgroup that is supported.If groups aren’t implemented, then this entire fieldis 0.|
    +-----+---+------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    |10:7 |R/W|dmexttrigger|This field contains the currently selected DM ex-ternal trigger.If a non-existent trigger value is written here, thehardware will change it to a valid one or 0 if noDM external triggers exist.                                                                                                                                                                                                                                                                                                                                                          |
    +-----+---+------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    |   11|R/W|grouptype   |0:  The remaining fields in this register configurehalt groups.1:  The remaining fields in this register configureresume groups.                                                                                                                                                                                                                                                                                                                                                                                                                          |
    +-----+---+------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

.. _riscv_dbg_dm_sbdata0:

sbdata0
"""""""

System Bus data 31:0

.. table:: 

    +-----+---+----+-----------+
    |Bit #|R/W|Name|Description|
    +=====+===+====+===========+
    |31:0 |R/W|data|Data value |
    +-----+---+----+-----------+
