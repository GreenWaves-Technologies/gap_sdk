# PSA Crypto Testcase checklist 



| Group                        | Test      | Function                   | Scenario                                                                                                              | Return Value                    | Steps                                                                                                            | Test Case                                                                                           |
|------------------------------|-----------|----------------------------|-----------------------------------------------------------------------------------------------------------------------|---------------------------------|------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------|
| Basic                        | test_c001 | psa_crypto_init            | Library initialization                                                                                                | PSA_SUCCESS                     | Calling this function should return SUCCESS                                                                      |                                                                                                     |
|                              |           |                            | Applications must call this function before calling any other function in this module.                                | PSA_SUCCESS                     | Try calling crypto operations doing a crypto_init should be successful(can be covered as part of other testcase) |                                                                                                     |
|                              |           |                            | Applications may call this function more than once. Once a call succeeds, subsequent calls are guaranteed to succeed. | PSA_SUCCESS                     | Try calling multiple crypto init and should return SUCCESS                                                       |                                                                                                     |
|                              |           |                            | Applications must call this function before calling any other function in this module.                                | PSA_ERROR_BAD_STATE             | Try calling crypto operations without doing a crypto_init should return FAILURE                                  |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  |                                                                                                     |
| Key Management               | test_c002 | psa_import_key             | Import a key in binary format.                                                                                        | PSA_SUCCESS                     | 1. Initialize the PSA crypto library                                                                             | 1. 16 Byte AES                                                                                      |
|                              |           |                            |                                                                                                                       |                                 | 2. Initialize a key policy structure to a default that forbids all usage of the key                              | 2. 24 Byte AES                                                                                      |
|                              |           |                            |                                                                                                                       |                                 | 3. Allocate a key slot for a transient key and set the standard fields of a policy structure                     | 3. 32 Byte AES                                                                                      |
|                              |           |                            |                                                                                                                       |                                 | 4. Set the usage policy on a key slot                                                                            | 4. 2048 RSA public key                                                                              |
|                              |           |                            |                                                                                                                       |                                 | 5. Import the key data into the key slot                                                                         | 5. 2048 RSA keypair                                                                                 |
|                              |           |                            |                                                                                                                       |                                 | 6. Get basic metadata about a key                                                                                | 6. DES 64 bit key                                                                                   |
|                              |           |                            |                                                                                                                       |                                 | 7. Export a key in binary format                                                                                 | 7. Triple DES 2-Key                                                                                 |
|                              |           |                            |                                                                                                                       |                                 | 8. Check if original key data matches with the exported data                                                     | 8. Triple DES 3-Key                                                                                 |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 9. EC Public key                                                                                    |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 10. EC keypair                                                                                      |
|                              |           |                            |                                                                                                                       | PSA_ERROR_NOT_SUPPORTED         | Calling this function with incorrect key type                                                                    | Incorrect key type                                                                                  |
|                              |           |                            |                                                                                                                       | PSA_ERROR_INVALID_ARGUMENT      | Calling this function with invalid parameter should return this error                                            | 1. Key data greater than the algorithm size                                                         |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 2. Incorrect key data size                                                                          |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  |                                                                                                     |
|                              |           |                            |                                                                                                                       | PSA_ERROR_INVALID_HANDLE        | Calling this function with invalid key handle should return this error                                           | 1. Invalid key slot </br> 2. Zero key slot                                                          |
|                              |           |                            |                                                                                                                       | PSA_ERROR_OCCUPIED_SLOT         | Pass the key slot to store data which is already occupied                                                        | Already occupied key slot                                                                           |
|                              | test_c003 | psa_export_key             | Export a key in binary format                                                                                         | PSA_SUCCESS                     | 1. Initialize the PSA crypto library                                                                             | 1. 16 Byte AES                                                                                      |
|                              |           |                            |                                                                                                                       |                                 | 2. Initialize a key policy structure to a default that forbids all usage of the key                              | 2. 24 Byte AES                                                                                      |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 3. Allocate a key slot for a transient key and set the standard fields of a policy structure                     | 3. 32 Byte AES                                                                                      |
|                              |           |                            |                                                                                                                       |                                 | 4. Set the usage policy on a key slot                                                                            | 4. 2048 RSA public key                                                                              |
|                              |           |                            |                                                                                                                       |                                 | 5. Import the key data into the key slot                                                                         | 5. 2048 RSA keypair                                                                                 |
|                              |           |                            |                                                                                                                       |                                 | 6. Get basic metadata about a key                                                                                | 6. DES 64 bit key                                                                                   |
|                              |           |                            |                                                                                                                       |                                 | 7. Export a key in binary format                                                                                 | 7. Triple DES 2-Key                                                                                 |
|                              |           |                            |                                                                                                                       |                                 | 8. Check if original key data matches with the exported data                                                     | 8. Triple DES 3-Key                                                                                 |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 9. EC Public key                                                                                    |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 10. EC keypair                                                                                      |
|                              |           |                            |                                                                                                                       | PSA_ERROR_BUFFER_TOO_SMALL      | Calling this function with buffer size less than required                                                        | Less buffer size                                                                                    |
|                              |           |                            |                                                                                                                       | PSA_ERROR_INVALID_HANDLE        | Calling this function with invalid parameter should return this error                                            | 1. Zero key slot                                                                                    |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 2. Invalid key slot                                                                                 |
|                              |           |                            |                                                                                                                       | PSA_ERROR_BAD_STATE             | Calling this function with key policy that cannot be exported                                                    | Invalid key policy usage                                                                            |
|                              |           |                            |                                                                                                                       | PSA_ERROR_EMPTY_SLOT            | Calling this function with empty key slot                                                                        | Empty key slot                                                                                      |
|                              | test_c004 | psa_export_public_key      | Export a public key or the public part of a key pair in binary format.                                                | PSA_SUCCESS                     | 1. Initialize the PSA crypto library                                                                             | 1. 2048 RSA public key                                                                              |
|                              |           |                            |                                                                                                                       |                                 | 2. Initialize a key policy structure to a default that forbids all usage of the key                              | 2. 2048 RSA keypair                                                                                 |
|                              |           |                            |                                                                                                                       |                                 | 3. Allocate a key slot for a transient key and set the standard fields of a policy structure                     | 3. EC Public key                                                                                    |
|                              |           |                            |                                                                                                                       |                                 | 4. Set the usage policy on a key slot                                                                            | 4. EC keypair                                                                                       |
|                              |           |                            |                                                                                                                       |                                 | 5. Import the key data into the key slot                                                                         |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 6. Get basic metadata about a key                                                                                |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 7. Export a key in binary format                                                                                 |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 8. Check if original key data matches with the exported data                                                     |                                                                                                     |
|                              |           |                            |                                                                                                                       | PSA_ERROR_INVALID_ARGUMENT      | 1. Initialize the PSA crypto library                                                                             | 1. 16 Byte AES                                                                                      |
|                              |           |                            |                                                                                                                       |                                 | 2. Initialize a key policy structure to a default that forbids all usage of the key                              | 2. 24 Byte AES                                                                                      |
|                              |           |                            |                                                                                                                       |                                 | 3. Allocate a key slot for a transient key and set the standard fields of a policy structure                     | 3. 32 Byte AES                                                                                      |
|                              |           |                            |                                                                                                                       |                                 | 4. Set the usage policy on a key slot                                                                            | 4. DES 64 bit key                                                                                   |
|                              |           |                            |                                                                                                                       |                                 | 5. Import the key data into the key slot                                                                         | 5. Triple DES 2-Key                                                                                 |
|                              |           |                            |                                                                                                                       |                                 | 6. Get basic metadata about a key                                                                                | 6. Triple DES 3-Key                                                                                 |
|                              |           |                            |                                                                                                                       |                                 | 7. Export a key in binary format                                                                                 |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 8. Check if original key data matches with the exported data                                                     |                                                                                                     |
|                              |           |                            |                                                                                                                       | PSA_ERROR_BUFFER_TOO_SMALL      | Calling this function with buffer size less than required                                                        | Less buffer size                                                                                    |
|                              |           |                            |                                                                                                                       | PSA_ERROR_INVALID_HANDLE        | Calling this function with invalid parameter should return this error                                            | 1. Zero key slot                                                                                    |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 2. Invalid key slot                                                                                 |
|                              |           |                            |                                                                                                                       | PSA_ERROR_BAD_STATE             | Calling this function with key policy that cannot be exported                                                    | Invalid key policy usage                                                                            |
|                              | test_c005 | psa_destroy_key            | Destroy a key and restore the slot to its default state.                                                              | PSA_SUCCESS                     | 1. Initialize the PSA crypto library                                                                             | 1. 16 Byte AES                                                                                      |
|                              |           |                            |                                                                                                                       |                                 | 2. Initialize a key policy structure to a default that forbids all usage of the key                              | 2. 24 Byte AES                                                                                      |
|                              |           |                            |                                                                                                                       |                                 | 3. Allocate a key slot for a transient key and set the standard fields of a policy structure                     | 3. 32 Byte AES                                                                                      |
|                              |           |                            |                                                                                                                       |                                 | 4. Set the usage policy on a key slot                                                                            | 4. 2048 RSA public key                                                                              |
|                              |           |                            |                                                                                                                       |                                 | 5. Import the key data into the key slot                                                                         | 5. 2048 RSA keypair                                                                                 |
|                              |           |                            |                                                                                                                       |                                 | 6. Get basic metadata about a key                                                                                | 6. DES 64 bit key                                                                                   |
|                              |           |                            |                                                                                                                       |                                 | 7. Destroy a key and restore the slot to its default state                                                       | 7. Triple DES 2-Key                                                                                 |
|                              |           |                            |                                                                                                                       |                                 | 8. Check that if the key metadata are destroyed                                                                  | 8. Triple DES 3-Key                                                                                 |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 9. EC Public key                                                                                    |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 10. EC keypair                                                                                      |
|                              |           |                            |                                                                                                                       | PSA_ERROR_INVALID_HANDLE        | Calling this function with invalid parameter should return this error                                            | 1. Invalid key slot                                                                                 |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 2. Zero key slot                                                                                    |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 3. Empty key slot                                                                                   |
|                              | test_c006 | psa_get_key_information    | Get basic metadata about a key.                                                                                       | PSA_SUCCESS                     | 1. Initialize the PSA crypto library                                                                             | 1. 16 Byte AES                                                                                      |
|                              |           |                            |                                                                                                                       |                                 | 2. Initialize a key policy structure to a default that forbids all usage of the key                              | 2. 24 Byte AES                                                                                      |
|                              |           |                            |                                                                                                                       |                                 | 3. Allocate a key slot for a transient key and set the standard fields of a policy structure                     | 3. 32 Byte AES                                                                                      |
|                              |           |                            |                                                                                                                       |                                 | 4. Set the usage policy on a key slot                                                                            | 4. 2048 RSA public key                                                                              |
|                              |           |                            |                                                                                                                       |                                 | 5. Import the key data into the key slot                                                                         | 5. 2048 RSA keypair                                                                                 |
|                              |           |                            |                                                                                                                       |                                 | 6. Get basic metadata about a key                                                                                | 6. DES 64 bit key                                                                                   |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 7. Triple DES 2-Key                                                                                 |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 8. Triple DES 3-Key                                                                                 |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 9. EC Public key                                                                                    |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 10. EC keypair                                                                                      |
|                              |           |                            |                                                                                                                       | PSA_ERROR_INVALID_HANDLE        | Calling this function with invalid parameter should return this error                                            | 1. Zero key slot                                                                                    |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 2. Invalid key slot                                                                                 |
|                              |           |                            |                                                                                                                       | PSA_ERROR_EMPTY_SLOT            | Pass the key slot number which has the key type as none                                                          | Empty key slot                                                                                      |
|                              | NO TEST   | psa_key_policy_set_usage   | Set the standard fields of a policy structure.                                                                        | void                            | Void function. Covered as part of other cases                                                                    |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  |                                                                                                     |
| Key Policies                 | test_c007 | psa_set_key_policy         | Set the usage policy on a key slot.                                                                                   | PSA_SUCCESS                     | 1. Initialize the PSA crypto library                                                                             | 1. 16 Byte AES                                                                                      |
|                              |           |                            |                                                                                                                       |                                 | 2. Initialize a key policy structure to a default that forbids all usage of the key                              | 2. 24 Byte AES                                                                                      |
|                              |           |                            |                                                                                                                       |                                 | 3. Allocate a key slot for a transient key and set the standard fields of a policy structure                     | 3. 32 Byte AES                                                                                      |
|                              |           |                            |                                                                                                                       |                                 | 4. Set the usage policy on a key slot                                                                            | 4. 2048 RSA public key                                                                              |
|                              |           |                            |                                                                                                                       |                                 | 5. Import the key data into the key slot                                                                         | 5. 2048 RSA keypair                                                                                 |
|                              |           |                            |                                                                                                                       |                                 | 6. Get the usage policy for a key slot                                                                           | 6. DES 64 bit key                                                                                   |
|                              |           |                            |                                                                                                                       |                                 | 7. Check if the policy matches the original input                                                                | 7. Triple DES 2-Key                                                                                 |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 8. Triple DES 3-Key                                                                                 |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 9. EC Public key                                                                                    |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 10. EC keypair                                                                                      |
|                              |           |                            |                                                                                                                       | PSA_ERROR_INVALID_HANDLE        | Calling this function with invalid parameter should return this error                                            | 1. Invalid key policy                                                                               |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 2. Zero key slot                                                                                    |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 3. Invalid key slot                                                                                 |
|                              |           |                            |                                                                                                                       | PSA_ERROR_OCCUPIED_SLOT         | Pass the key slot to store data which is already occupied                                                        | Already occupied key slot                                                                           |
|                              | test_c008 | psa_get_key_policy         | Get the usage policy for a key slot                                                                                   | PSA_SUCCESS                     | 1. Initialize the PSA crypto library                                                                             | 1. 16 Byte AES                                                                                      |
|                              |           |                            |                                                                                                                       |                                 | 2. Initialize a key policy structure to a default that forbids all usage of the key                              | 2. 24 Byte AES                                                                                      |
|                              |           |                            |                                                                                                                       |                                 | 3. Allocate a key slot for a transient key and set the standard fields of a policy structure                     | 3. 32 Byte AES                                                                                      |
|                              |           |                            |                                                                                                                       |                                 | 4. Set the usage policy on a key slot                                                                            | 4. 2048 RSA public key                                                                              |
|                              |           |                            |                                                                                                                       |                                 | 5. Change the lifetime of a key slot                                                                             | 5. 2048 RSA keypair                                                                                 |
|                              |           |                            |                                                                                                                       |                                 | 6. Import the key data into the key slot                                                                         | 6. DES 64 bit key                                                                                   |
|                              |           |                            |                                                                                                                       |                                 | 7. Get the usage policy for a key slot                                                                           | 7. Triple DES 2-Key                                                                                 |
|                              |           |                            |                                                                                                                       |                                 | 8. Retrieve the usage field of a policy structure                                                                | 8. Triple DES 3-Key                                                                                 |
|                              |           |                            |                                                                                                                       |                                 | 9. Retrieve the algorithm field of a policy structure                                                            | 9. EC Public key                                                                                    |
|                              |           |                            |                                                                                                                       |                                 | 10. Make sure they match the original value                                                                      | 10. EC keypair                                                                                      |
|                              |           |                            |                                                                                                                       | PSA_ERROR_INVALID_HANDLE        | Calling this function with invalid parameter should return this error                                            | 1. Zero key slot                                                                                    |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 2. Invalid key slot                                                                                 |
|                              | test_c009 | psa_allocate_key           | Allocate a key slot for a transient key                                                                               | PSA_SUCCESS                     | 1. Initialize the PSA crypto library                                                                             | 1. Volatile keys                                                                                    |
|                              |           |                            |                                                                                                                       |                                 | 2. Initialize a key policy structure to a default that forbids all usage of the key                              |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 3. Allocate a key slot for a transient key                                                                       |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  |                                                                                                     |
|                              |           |                            |                                                                                                                       | PSA_ERROR_INSUFFICIENT_MEMORY   | Calling this function with multiple time                                                                         |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  |                                                                                                     |
|                              | test_c010 | psa_get_key_lifetime       | Retrieve the lifetime of a key slot.                                                                                  | PSA_SUCCESS                     | 1. Initialize the PSA crypto library                                                                             | Testing only volatile keys as other key types are currently not supported                           |
|                              |           |                            |                                                                                                                       |                                 | 2. Initialize a key policy structure to a default that forbids all usage of the key                              |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 3. Allocate a key slot for a transient key and set the standard fields of a policy structure                     |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 4. Set the usage policy on a key slot                                                                            |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 5. Change the lifetime of a key slot                                                                             |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 6. Import the key data into the key slot                                                                         |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 7. Get the lifetime of a key slot                                                                                |                                                                                                     |
|                              |           |                            |                                                                                                                       | PSA_ERROR_INVALID_HANDLE        |                                                                                                                  | 1. Zero key slot                                                                                    |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 2. Invalid key slot                                                                                 |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 3. Empty key slot                                                                                   |
|                              |           |                            |                                                                                                                       | PSA_ERROR_INVALID_ARGUMENT      |                                                                                                                  | 1. Invalid key policy                                                                               |
| Message Authentication Codes | test_c011 | psa_hash_start             | Start a multipart hash operation.                                                                                     | PSA_SUCCESS                     | 1. Initialize the PSA crypto library                                                                             | 1. MD2                                                                                              |
|                              |           |                            |                                                                                                                       |                                 | 2. Start a multipart hash operation                                                                              | 2. MD4                                                                                              |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 3. MD5                                                                                              |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 4. RIPEMD160                                                                                        |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 5. SHA1                                                                                             |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 6. SHA224                                                                                           |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 7. SHA256                                                                                           |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 8. SHA512                                                                                           |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 9. SHA512_224                                                                                       |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 10. SHA512_256                                                                                      |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 11. SHA3_224 1                                                                                      |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 2. SHA3_256 1                                                                                       |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 3. SHA3_384 1                                                                                       |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 4. SHA3_512                                                                                         |
|                              |           |                            |                                                                                                                       | PSA_ERROR_NOT_SUPPORTED         | Calling this function with unsupported algorithm should return error                                             | Invalid hash algorithm                                                                              |
|                              | test_c012 | psa_hash_update            | Add a message fragment to a multipart hash operation.                                                                 | PSA_SUCCESS                     | 1. Initialize the PSA crypto library                                                                             | 1. MD2                                                                                              |
|                              |           |                            |                                                                                                                       |                                 | 2. Start a multipart hash operation                                                                              | 2. MD4                                                                                              |
|                              |           |                            |                                                                                                                       |                                 | 3. Add a message fragment to a multipart hash operation                                                          | 3. MD5                                                                                              |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 4. RIPEMD160                                                                                        |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 5. SHA1                                                                                             |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 6. SHA224                                                                                           |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 7. SHA256                                                                                           |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 8. SHA384                                                                                           |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 9. SHA512                                                                                           |
|                              |           |                            |                                                                                                                       | PSA_ERROR_INVALID_ARGUMENT      | Calling this function without calling the psa_hash_start() should return error                                   | Inactive operation handle                                                                           |
|                              |           |                            |                                                                                                                       | PSA_ERROR_INVALID_ARGUMENT      | Calling this function with completed operation handle should return error                                        | Completed operation handle                                                                          |
|                              | test_c013 | psa_hash_verify            | Finish the calculation of the hash of a message and compare it with an expected value.                                | PSA_SUCCESS                     | 1. Initialize the PSA crypto library                                                                             | 1. MD2                                                                                              |
|                              |           |                            |                                                                                                                       |                                 | 2. Start a multipart hash operation                                                                              | 2. MD4                                                                                              |
|                              |           |                            |                                                                                                                       |                                 | 3. Add a message fragment to a multipart hash operation                                                          | 3. MD5                                                                                              |
|                              |           |                            |                                                                                                                       |                                 | 4. Finish the calculation of the hash of a message and compare it with an expected value                         | 4. RIPEMD160                                                                                        |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 5. SHA1                                                                                             |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 6. SHA224                                                                                           |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 7. SHA256                                                                                           |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 8. SHA384                                                                                           |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 9. SHA512                                                                                           |
|                              |           |                            |                                                                                                                       | PSA_ERROR_INVALID_ARGUMENT      | Calling this function with inactive operation handle should return error                                         | Inactive operation handle                                                                           |
|                              |           |                            |                                                                                                                       | PSA_ERROR_INVALID_SIGNATURE     | Calling this function with incorrect expected value should return error                                          | 1. Incorrect expected hash value                                                                    |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 2. Incorrect expected hash length                                                                   |
|                              | test_c014 | psa_hash_finish            | Finish the calculation of the hash of a message.                                                                      | PSA_SUCCESS                     | 1. Initialize the PSA crypto library                                                                             | 1. MD2                                                                                              |
|                              |           |                            |                                                                                                                       |                                 | 2. Start a multipart hash operation                                                                              | 2. MD4                                                                                              |
|                              |           |                            |                                                                                                                       |                                 | 3. Add a message fragment to a multipart hash operation                                                          | 3. MD5                                                                                              |
|                              |           |                            |                                                                                                                       |                                 | 4. Finish the calculation of the hash of a message                                                               | 4. RIPEMD160                                                                                        |
|                              |           |                            |                                                                                                                       |                                 | 5. Compare it with the expected value                                                                            | 5. SHA1                                                                                             |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 6. SHA224                                                                                           |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 7. SHA256                                                                                           |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 8. SHA384                                                                                           |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 9. SHA512                                                                                           |
|                              |           |                            |                                                                                                                       | PSA_ERROR_INVALID_ARGUMENT      | Calling this function with an inactive operation handle should return error                                      | Inactive operation handle                                                                           |
|                              |           |                            |                                                                                                                       | PSA_ERROR_BUFFER_TOO_SMALL      | Calling this function with a hash buffer whose size is less than the algorithm output should return error        | Buffer size less than required                                                                      |
|                              | test_c015 | psa_hash_abort             | Abort a hash operation.                                                                                               | PSA_SUCCESS                     | 1. Initialize the PSA crypto library                                                                             | 1. MD2                                                                                              |
|                              |           |                            |                                                                                                                       |                                 | 2. Start a multipart hash operation                                                                              | 2. MD4                                                                                              |
|                              |           |                            |                                                                                                                       |                                 | 3. Abort a hash operation                                                                                        | 3. MD5                                                                                              |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 4. RIPEMD160                                                                                        |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 5. SHA1                                                                                             |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 6. SHA224                                                                                           |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 7. SHA256                                                                                           |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 8. SHA384                                                                                           |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 9. SHA512                                                                                           |
|                              |           |                            |                                                                                                                       | PSA_ERROR_INVALID_ARGUMENT      | Calling psa_hash_finish after calling psa_hash_abort should return error                                         |                                                                                                     |
| Generator                    | test_c016 | psa_generate_key           | Generate a key or key pair                                                                                            | PSA_SUCCESS                     | 1. Initialize the PSA crypto library                                                                             | 1. AES                                                                                              |
|                              |           |                            |                                                                                                                       |                                 | 2. Initialize a key policy structure                                                                             | 2. DES                                                                                              |
|                              |           |                            |                                                                                                                       |                                 | 3. Allocate a key slot for a transient key and set the standard fields of a policy structure                     | 3. ECC                                                                                              |
|                              |           |                            |                                                                                                                       |                                 | 4. Set the usage policy on a key slot                                                                            | 4. RSA                                                                                              |
|                              |           |                            |                                                                                                                       |                                 | 5. Generate a key or key pair                                                                                    |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 6. Get basic metadata about a key                                                                                |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 7. Check if key type and key length matches                                                                      |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 8. Export a key in binary format                                                                                 |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 9. Check if the metadata matches                                                                                 |                                                                                                     |
|                              |           |                            |                                                                                                                       | PSA_ERROR_INVALID_HANDLE        | Calling this function with invalid key slot should return this error                                             | Invalid key slot                                                                                    |
|                              |           |                            |                                                                                                                       | PSA_ERROR_INVALID_HANDLE        | Calling this function with zero as key slot should return this error                                             | Zero as key slot                                                                                    |
|                              |           |                            |                                                                                                                       | PSA_ERROR_INVALID_ARGUMENT      | Calling this function with Null extra and Non-Zero extra size should return this error                           | Null extra and Non-Zero extra size                                                                  |
|                              |           |                            |                                                                                                                       | PSA_ERROR_OCCUPIED_SLOT         | Calling this function with pre-occupied key slot should return this error                                        | Pre-occupied key slot                                                                               |
|                              |           |                            |                                                                                                                       | PSA_ERROR_NOT_SUPPORTED         | Calling this function to generate only public key should return this error                                       | Key type as public key                                                                              |
|                              | test_c017 | psa_generate_random        | Generate random bytes                                                                                                 | PSA_SUCCESS                     | 1. Initialize the PSA crypto library                                                                             | 1. 16 Byte data                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 2. Generate random bytes                                                                                         | 2. 24 Byte data                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 3. Check that if generated data are Non-Zero                                                                     | 3. 32 Byte data                                                                                     |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 4. 64 Byte data                                                                                     |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 5. 128 Byte data                                                                                    |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 6. 256 Byte data                                                                                    |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 7. 512 Byte data                                                                                    |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 8. 1000 Byte data                                                                                   |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 9. 1024 Byte data                                                                                   |
|                              | test_c018 | psa_generator_read         | Read some data from a generator                                                                                       | PSA_SUCCESS                     | 1. Initialize the PSA crypto library                                                                             | 1. 16 Byte key                                                                                      |
|                              |           |                            |                                                                                                                       |                                 | 2. Initialize a key policy structure                                                                             | 2. 32 Byte key                                                                                      |
|                              |           |                            |                                                                                                                       |                                 | 3. Allocate a key slot for a transient key and set the standard fields of a policy structure                     | 3. 8 Byte Key                                                                                       |
|                              |           |                            |                                                                                                                       |                                 | 4. Set the usage policy on a key slot                                                                            | 4. SHA 256                                                                                          |
|                              |           |                            |                                                                                                                       |                                 | 5. Import the key data into the key slot                                                                         | 5. SHA 512                                                                                          |
|                              |           |                            |                                                                                                                       |                                 | 6. Set up a key derivation operation                                                                             | 6. SHA 1                                                                                            |
|                              |           |                            |                                                                                                                       |                                 | 7. Generate random bytes                                                                                         | 7. Output size less than generator capacity                                                         |
|                              |           |                            |                                                                                                                       |                                 | 8. Check that if generated data are non-zero                                                                     | 8. Output size equal to generator capacity                                                          |
|                              |           |                            |                                                                                                                       |                                 | 9. Generate random bytes for remaining capacity                                                                  | 9. Request maximum capacity                                                                         |
|                              |           |                            |                                                                                                                       |                                 | 10. Check that if generated data are non-zero                                                                    |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 11. Generate random bytes and check that it fails                                                                |                                                                                                     |
|                              |           |                            |                                                                                                                       | PSA_ERROR_INSUFFICIENT_CAPACITY | Calling this function with output size greater than the current capacity should return this error                | output size greater than the current capacity                                                       |
|                              |           |                            |                                                                                                                       | PSA_ERROR_INSUFFICIENT_CAPACITY | Calling this function with capacity greater than the allowed capacity should return this error                   | request maximum capacity +1                                                                         |
|                              | test_c019 | psa_generator_get_capacity | Retrieve the current capacity of a generator                                                                          | PSA_SUCCESS                     | 1. Initialize the PSA crypto library                                                                             | 1. Output size less than generator capacity                                                         |
|                              |           |                            |                                                                                                                       |                                 | 2. Initialize a key policy structure                                                                             | 2. Output size equal to generator capacity                                                          |
|                              |           |                            |                                                                                                                       |                                 | 3. Allocate a key slot for a transient key and set the standard fields of a policy structure                     |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 4. Set the usage policy on a key slot                                                                            |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 5. Import the key data into the key slot                                                                         |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 6. Set up a key derivation operation                                                                             |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 7. Retrieve the current capacity of a generator                                                                  |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 8. Check that it is equal to the input capacity                                                                  |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 9. Generate random bytes                                                                                         |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 10. Retrieve the current capacity of a generator                                                                 |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 11. Check that it is equal to the remaining capacity                                                             |                                                                                                     |
|                              | test_c020 | psa_generator_import_key   | Create a symmetric key from data read from a generator                                                                | PSA_SUCCESS                     | 1. Initialize the PSA crypto library                                                                             | 1. 16 Byte AES                                                                                      |
|                              |           |                            |                                                                                                                       |                                 | 2. Initialize a key policy structure                                                                             | 2. 32 Byte AES                                                                                      |
|                              |           |                            |                                                                                                                       |                                 | 3. Allocate a key slot for a transient key and set the standard fields of a policy structure                     |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 4. Set the usage policy on a key slot                                                                            |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 5. Import the key data into the key slot                                                                         |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 6. Set up a key derivation operation                                                                             |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 7. Initialize a key policy structure for new slot                                                                |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 8. Set the standard fields of a policy structure                                                                 |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 9. Set the usage policy on a new key slot                                                                        |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 10. Create a symmetric key from data read from a generator                                                       |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 11. Export a key in binary format                                                                                |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 12. Check that length of the key matches                                                                         |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 13. Check that the key is non-zero                                                                               |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 14. Initialize a key policy structure for new slot                                                               |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 15. Set the standard fields of a policy structure                                                                |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 16. Set the usage policy on a new key slot                                                                       |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 17. Create a symmetric key from data read from a generator for the remaining size                                |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 18. Export a key in binary format                                                                                |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 19. Check that length of the key matches                                                                         |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 20. Check that the key is non-zero                                                                               |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 21. Initialize a key policy structure for new slot                                                               |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 22. Set the standard fields of a policy structure                                                                |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 23. Set the usage policy on a new key slot                                                                       |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 24. Create a symmetric key from data read from a generator for the some size                                     |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | Check that it fails                                                                                              |                                                                                                     |
|                              |           |                            |                                                                                                                       | PSA_ERROR_INSUFFICIENT_CAPACITY | Calling this function with output greater than capacity should return this error                                 | Output greater than capacity                                                                        |
|                              |           |                            |                                                                                                                       | PSA_ERROR_INVALID_ARGUMENT      | Calling this function with public key algorithm should return this error                                         | 1. RSA public key </br>2.Invalid key size                                                           |
|                              |           |                            |                                                                                                                       | PSA_ERROR_INVALID_HANDLE        | Calling this function with invalid arguments should return this error                                            | 1. Invalid key slot                                                                                 |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 2. Zero as key slot                                                                                 |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  |                                                                                                     |
|                              |           |                            |                                                                                                                       | PSA_ERROR_OCCUPIED_SLOT         | Calling this function with already occupied key slot should return this error                                    | Pre-occupied key slot                                                                               |
|                              | test_c021 | psa_generator_abort        | Abort a generator                                                                                                     | PSA_SUCCESS                     | 1. Initialize the PSA crypto library                                                                             | 1. Abort                                                                                            |
|                              |           |                            |                                                                                                                       |                                 | 2. Initialize a key policy structure                                                                             | 2. Multiple                                                                                         |
|                              |           |                            |                                                                                                                       |                                 | 3. Allocate a key slot for a transient key and set the standard fields of a policy structure                     | 3. Calling generator functions after abort should fail                                              |
|                              |           |                            |                                                                                                                       |                                 | 4. Set the usage policy on a key slot                                                                            |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 5. Import the key data into the key slot                                                                         |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 6. Set the key for a multipart symmetric encryption/decryption operation                                         |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 7. Abort a cipher operation                                                                                      |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 8. Multiple abort cipher operation should return success                                                         |                                                                                                     |
| Key derivation               | test_c022 | psa_key_derivation         | Set up a key derivation operation                                                                                     | PSA_SUCCESS                     | 1. Initialize the PSA crypto library                                                                             | 1. 16 Byte data with SHA-256                                                                        |
|                              |           |                            |                                                                                                                       |                                 | 2. Initialize a key policy structure                                                                             | 2. 32 byte data with SHA-512                                                                        |
|                              |           |                            |                                                                                                                       |                                 | 3. Allocate a key slot for a transient key and set the standard fields of a policy structure                     | 3. 32 Byte data with MD-5                                                                           |
|                              |           |                            |                                                                                                                       |                                 | 4. Import the key data into the key slot                                                                         | 4. Salt and label provided as input                                                                 |
|                              |           |                            |                                                                                                                       |                                 | 5. Set up a key derivation operation                                                                             |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 6. Retrieve the current capacity of a generator                                                                  |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 7. Make sure that the capacity is same as input capacity                                                         |                                                                                                     |
|                              |           |                            |                                                                                                                       | PSA_INVALID_ARGUMENT            | Calling this function with invalid argument should return this error                                             | 1. Invalid algorithm 2. Unsupported generator capacity                                              |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 3. Unsupported key type                                                                             |
|                              |           |                            |                                                                                                                       | PSA_ERROR_INVALID_HANDLE        | Calling this functoin wih incorrect key handle                                                                   | 1. Invalid key handle </br>2. Zero as key slot                                                      |
|                              |           |                            |                                                                                                                       | PSA_ERROR_EMPTY_SLOT            | Calling this function with empty key slot should return this error                                               | Empty key slot                                                                                      |
| Key policies                 | test_c023 | psa_key_policy_get_usage   | Retrieve the usage field of a policy structure                                                                        | PSA_SUCCESS                     | 1. Initialize the PSA crypto library                                                                             | 1. Encrypt                                                                                          |
|                              |           |                            |                                                                                                                       |                                 | 2. Initialize a key policy structure                                                                             | 2. Decrypt                                                                                          |
|                              |           |                            |                                                                                                                       |                                 | 3. Allocate a key slot for a transient key and set the standard fields of a policy structure                     | 3. Export                                                                                           |
|                              |           |                            |                                                                                                                       |                                 | 4. Retrieve the usage field of a policy structure                                                                | 4. Sign                                                                                             |
|                              |           |                            |                                                                                                                       |                                 | 5. Check that usage is same as input                                                                             | 5. Verify                                                                                           |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 6. Derive                                                                                           |
| AEAD                         | test_c024 | psa_aead_encrypt           | Process an authenticated encryption operation                                                                         | PSA_SUCCESS                     | 1. Initialize the PSA crypto library                                                                             | 1. CCM - 16B AES - Nounce and additional data                                                       |
|                              |           |                            |                                                                                                                       |                                 | 2. Initialize a key policy structure                                                                             | 2. GCM - 16B AES - NULL Nounce & addi data                                                          |
|                              |           |                            |                                                                                                                       |                                 | 3. Allocate a key slot for a transient key and set the standard fields of a policy structure                     | 3. GCM -16B AES - 12B Nounce & 12B addi data                                                        |
|                              |           |                            |                                                                                                                       |                                 | 4. Set the usage policy on a key slot                                                                            | 4. CCM - 16B AES - 13B Nounce & 8B addi data                                                        |
|                              |           |                            |                                                                                                                       |                                 | 5. Import the key data into the key slot                                                                         |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 6. Call aead encrypt                                                                                             |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 7. Check if the status is expected                                                                               |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 8. Check if the cipher text is expected length                                                                   |                                                                                                     |
|                              |           |                            |                                                                                                                       | PSA_ERROR_NOT_SUPPORTED         |                                                                                                                  | 1. DES key                                                                                          |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 2. Unsupported algorithm                                                                            |
|                              |           |                            |                                                                                                                       | PSA_ERROR_EMPTY_SLOT            |                                                                                                                  | Empty key slot                                                                                      |
|                              |           |                            |                                                                                                                       | PSA_ERROR_INVALID_HANDLE        |                                                                                                                  | 1. Zero as key slot                                                                                 |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 2. Invalid key slot                                                                                 |
|                              |           |                            |                                                                                                                       | PSA_ERROR_NOT_PERMITTED         |                                                                                                                  | 1. Small output buffer size                                                                         |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 2. Invalid key usage                                                                                |
|                              | test_c025 | psa_aead_decrypt           | Process an authenticated decryption operation                                                                         | PSA_SUCCESS                     | 1. Initialize the PSA crypto library                                                                             | 1. CCM - 16B AES - Nounce and additional data                                                       |
|                              |           |                            |                                                                                                                       |                                 | 2. Initialize a key policy structure                                                                             | 2. GCM - 16B AES - NULL Nounce & addi data                                                          |
|                              |           |                            |                                                                                                                       |                                 | 3. Allocate a key slot for a transient key and set the standard fields of a policy structure                     | 3. GCM -16B AES - 12B Nounce & 12B addi data                                                        |
|                              |           |                            |                                                                                                                       |                                 | 4. Set the usage policy on a key slot                                                                            | 4. CCM - 16B AES - 13B Nounce & 8B addi data                                                        |
|                              |           |                            |                                                                                                                       |                                 | 5. Import the key data into the key slot                                                                         |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 6. Call aead decrypt                                                                                             |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 7. Check if the status is expected                                                                               |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 8. Check if the plain text is expected length                                                                    |                                                                                                     |
|                              |           |                            |                                                                                                                       | PSA_ERROR_NOT_SUPPORTED         |                                                                                                                  | 1. DES key                                                                                          |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 2. Unsupported algorithm                                                                            |
|                              |           |                            |                                                                                                                       | PSA_ERROR_EMPTY_SLOT            |                                                                                                                  | Empty key slot                                                                                      |
|                              |           |                            |                                                                                                                       | PSA_ERROR_INVALID_HANDLE        |                                                                                                                  | 1. Zero as key slot                                                                                 |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 2. Invalid key slot                                                                                 |
|                              |           |                            |                                                                                                                       | PSA_ERROR_NOT_PERMITTED         |                                                                                                                  | 1. Small output buffer size                                                                         |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 2. Invalid key usage                                                                                |
| Message Authentication Codes | test_c026 | psa_mac_sign_setup         | Start a multipart MAC calculation operation                                                                           | PSA_SUCCESS                     | 1. Initialize the PSA crypto library                                                                             | 1. 64 Byte HMAC                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 2. Initialize a key policy structure                                                                             | 2. 16 Byte AES - CMAC                                                                               |
|                              |           |                            |                                                                                                                       |                                 | 3. Allocate a key slot for a transient key and set the standard fields of a policy structure                     |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 4. Set the usage policy on a key slot                                                                            |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 5. Import the key data into the key slot                                                                         |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 6. Start a multipart MAC calculation operation                                                                   |                                                                                                     |
|                              |           |                            |                                                                                                                       | PSA_ERROR_NOT_SUPPORTED         |                                                                                                                  | 1. 16 Byte AES - GMAC                                                                               |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 2. Incompatible HMAC for CMAC                                                                       |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 3. Bad algorithm (unknown MAC algorithm)<br /<                                                      |
|                              |           |                            |                                                                                                                       | PSA_ERROR_NOT_PERMITTED         |                                                                                                                  | Invalid usage                                                                                       |
|                              |           |                            |                                                                                                                       | PSA_ERROR_EMPTY_SLOT            |                                                                                                                  | Empty key slot                                                                                      |
|                              |           |                            |                                                                                                                       | PSA_ERROR_INVALID_HANDLE        |                                                                                                                  | 1. Invalid key type                                                                                 |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 2. Truncated MAC too large                                                                          |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 3                                                                                                   |
|                              | test_c027 | psa_mac_update             | Add a message fragment to a multipart MAC operation                                                                   | PSA_SUCCESS                     | 1. Initialize the PSA crypto library                                                                             | 1.64 Byte HMAC SHA256                                                                               |
|                              |           |                            |                                                                                                                       |                                 | 2. Initialize a key policy structure                                                                             | 2. 16 Byte AES - CMAC                                                                               |
|                              |           |                            |                                                                                                                       |                                 | 3. Allocate a key slot for a transient key and set the standard fields of a policy structure                     | 3. 32 Byte HMAC SHA512                                                                              |
|                              |           |                            |                                                                                                                       |                                 | 4. Set the usage policy on a key slot                                                                            |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 5. Import the key data into the key slot                                                                         |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 6. Start a multipart MAC calculation operation                                                                   |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 7. Add a message fragment to a multipart MAC operation                                                           |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 8. Check for the expected status                                                                                 |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 9. If success, Finish the calculation of the MAC of a message                                                    |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 10. Add a message fragment to the same multipart MAC operation should fail                                       |                                                                                                     |
|                              |           |                            |                                                                                                                       | PSA_ERROR_BAD_STATE             |                                                                                                                  | 1. Completed operation as input                                                                     |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 2. Uninitialized operation as input                                                                 |
|                              | test_c028 | psa_mac_sign_finish        | Finish the calculation of the MAC of a message                                                                        | PSA_SUCCESS                     | 1. Initialize the PSA crypto library                                                                             | 1. HMAC SHA 224                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 2. Initialize a key policy structure                                                                             | 2. HMAC SHA 256                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 3. Allocate a key slot for a transient key and set the standard fields of a policy structure                     | 3. HMAC SHA 512                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 4. Set the usage policy on a key slot                                                                            | 4. HMAC SHA 224 (truncated to 8 Byte)                                                               |
|                              |           |                            |                                                                                                                       |                                 | 5. Import the key data into the key slot                                                                         | 5. CMAC AES 128                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 6. Start a multipart MAC calculation operation                                                                   |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 7. Add a message fragment to a multipart MAC operation                                                           |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 8. Finish the calculation of the MAC of a message                                                                |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 9. Check for the expected status                                                                                 |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 10. If success, Check if the MAC length matches with the expected length                                         |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 11. Check if the MAC data matches with the expected data                                                         |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 12. Finish the calculation of the MAC of a message using same operation should return error                      |                                                                                                     |
|                              |           |                            |                                                                                                                       | PSA_ERROR_BUFFER_TOO_SMALL      |                                                                                                                  | Small size buffer                                                                                   |
|                              |           |                            |                                                                                                                       | PSA_ERROR_BAD_STATE             |                                                                                                                  | Invalid operation as input                                                                          |
|                              | test_c029 | psa_mac_verify_setup       |                                                                                                                       | PSA_SUCCESS                     | 1. Initialize the PSA crypto library                                                                             | 1. 64 Byte HMAC                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 2. Initialize a key policy structure                                                                             | 2. 16 Byte AES - CMAC                                                                               |
|                              |           |                            |                                                                                                                       |                                 | 3. Allocate a key slot for a transient key and set the standard fields of a policy structure                     |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 4. Set the usage policy on a key slot                                                                            |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 5. Import the key data into the key slot                                                                         |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 6. Start a multipart MAC verification operation                                                                  |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 7. Check for the expected status                                                                                 |                                                                                                     |
|                              |           |                            |                                                                                                                       | PSA_ERROR_NOT_SUPPORTED         |                                                                                                                  | 1. 16 Byte AES - GMAC                                                                               |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 2. Incompatible HMAC for CMAC                                                                       |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 3. Bad algorithm (unknown MAC algorithm)<br /<                                                      |
|                              |           |                            |                                                                                                                       | PSA_ERROR_NOT_PERMITTED         |                                                                                                                  | Invalid usage                                                                                       |
|                              |           |                            |                                                                                                                       | PSA_ERROR_EMPTY_SLOT            |                                                                                                                  | Empty slot as input                                                                                 |
|                              |           |                            |                                                                                                                       | PSA_ERROR_INVALID_HANDLE        |                                                                                                                  | 1. Invalid key type                                                                                 |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 2. Truncated MAC too large                                                                          |
|                              | test_c030 | psa_mac_verify_finish      | Finish the calculation of the MAC of a message and compare it with an expected value                                  | PSA_SUCCESS                     | 1. Initialize the PSA crypto library                                                                             | 1. HMAC SHA 224                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 2. Initialize a key policy structure                                                                             | 2. HMAC SHA 256                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 3.Allocate a key slot for a transient key and set the standard fields of a policy structure                      | 3. HMAC SHA 512                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 4. Set the usage policy on a key slot                                                                            | 4. HMAC SHA 224 (truncated to 8 Byte)                                                               |
|                              |           |                            |                                                                                                                       |                                 | 5. Import the key data into the key slot                                                                         | 5. CMAC AES 128                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 6. Start a multipart MAC calculation operation                                                                   |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 7. Add a message fragment to a multipart MAC operation                                                           |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 8. Finish the calculation of the MAC of a message                                                                |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 9. Check for the expected status                                                                                 |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 10. Finish the calculation of the MAC of a message using same operation should return error                      |                                                                                                     |
|                              |           |                            |                                                                                                                       | PSA_ERROR_INVALID_SIGNATURE     |                                                                                                                  | 1. Small size buffer                                                                                |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 2. Incorrect expected hash                                                                          |
|                              |           |                            |                                                                                                                       | PSA_ERROR_BAD_STATE             |                                                                                                                  | Invalid operation as input                                                                          |
|                              | test_c031 | psa_mac_abort              | Abort a MAC operation                                                                                                 | PSA_SUCCESS                     | 1. Initialize the PSA crypto library                                                                             | 1. HMAC SHA 224                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 2. Initialize a key policy structure                                                                             | 2. HMAC SHA 256                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 3. Allocate a key slot for a transient key and set the standard fields of a policy structure                     | 3. HMAC SHA 512                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 4. Set the usage policy on a key slot                                                                            | 4. CMAC AES 128                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 5. Import the key data into the key slot                                                                         | 5. HMAC truncated                                                                                   |
|                              |           |                            |                                                                                                                       |                                 | 6. Start a multipart MAC calculation operation                                                                   | 6. Multiple abort                                                                                   |
|                              |           |                            |                                                                                                                       |                                 | 7. Abort the MAC operation                                                                                       | 7. psa_mac_finish after psa_mac_abort should return failure                                         |
| Symmetric Ciphers            | test_c032 | psa_cipher_encrypt_setup   | Set the key for a multipart symmetric encryption operation                                                            | PSA_SUCCESS                     | 1. Initialize the PSA crypto library                                                                             | 1. 16 Byte AES                                                                                      |
|                              |           |                            |                                                                                                                       |                                 | 2. Initialize a key policy structure                                                                             | 2. 24 Byte AES                                                                                      |
|                              |           |                            |                                                                                                                       |                                 | 3. Allocate a key slot for a transient key and set the standard fields of a policy structure                     | 3. 32 Byte AES                                                                                      |
|                              |           |                            |                                                                                                                       |                                 | 4. Set the usage policy on a key slot                                                                            | 4. DES 64 bit key                                                                                   |
|                              |           |                            |                                                                                                                       |                                 | 5. Import the key data into the key slot                                                                         | 5. Triple DES 2-Key                                                                                 |
|                              |           |                            |                                                                                                                       |                                 | 6. Set the key for a multipart symmetric encryption operation                                                    | 6. Triple DES 3-Key                                                                                 |
|                              |           |                            |                                                                                                                       | PSA_ERROR_NOT_SUPPORTED         |                                                                                                                  | 1. 16 Byte raw data                                                                                 |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 2. Unknown cipher algorithm                                                                         |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 3. Incompatible key ARC4                                                                            |
|                              |           |                            |                                                                                                                       | PSA_ERROR_INVALID_ARGUMENT      |                                                                                                                  | 1. Not a cipher algorithm                                                                           |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 2. Invalid key slot                                                                                 |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 3. Zero as key slot                                                                                 |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 4. RSA public key                                                                                   |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 5. RSA keypair                                                                                      |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 6. EC Public key                                                                                    |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 7. EC keypair                                                                                       |
|                              |           |                            |                                                                                                                       | PSA_ERROR_EMPTY_SLOT            |                                                                                                                  | Empty key slot                                                                                      |
|                              |           |                            |                                                                                                                       | PSA_ERROR_NOT_PERMITTED         |                                                                                                                  | Incorrect usage                                                                                     |
|                              | test_c033 | psa_cipher_decrypt_setup   | Set the key for a multipart symmetric decryption operation                                                            | PSA_SUCCESS                     | 1. Initialize the PSA crypto library                                                                             | 1. HMAC SHA 224                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 2. Initialize a key policy structure                                                                             | 2. HMAC SHA 256                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 3. Allocate a key slot for a transient key and set the standard fields of a policy structure                     | 3. HMAC SHA 512                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 4. Set the usage policy on a key slot                                                                            | 4. CMAC AES 128                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 5. Import the key data into the key slot                                                                         | 5. HMAC truncated                                                                                   |
|                              |           |                            |                                                                                                                       |                                 | 6. Set the key for a multipart symmetric decryption operation                                                    | 6. Multiple abort                                                                                   |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 7. psa_mac_finish after psa_mac_abort should return failure                                         |
|                              |           |                            |                                                                                                                       | PSA_ERROR_NOT_SUPPORTED         |                                                                                                                  | 1. 16 Byte raw data                                                                                 |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 2. Unknown cipher algorithm                                                                         |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 3. Incompatible key ARC4                                                                            |
|                              |           |                            |                                                                                                                       | PSA_ERROR_INVALID_ARGUMENT      |                                                                                                                  | 1. Not a cipher algorithm                                                                           |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 2. Invalid key slot                                                                                 |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 3. Zero as key slot                                                                                 |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 4. RSA public key                                                                                   |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 5. RSA keypair                                                                                      |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 6. EC Public key                                                                                    |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 7. EC keypair                                                                                       |
|                              |           |                            |                                                                                                                       | PSA_ERROR_EMPTY_SLOT            |                                                                                                                  | Empty key slot                                                                                      |
|                              |           |                            |                                                                                                                       | PSA_ERROR_NOT_PERMITTED         |                                                                                                                  | Invalid usage                                                                                       |
|                              | test_c034 | psa_cipher_generate_iv     | Generate an IV for a symmetric encryption operation                                                                   | PSA_SUCCESS                     | 1. Initialize the PSA crypto library                                                                             | 1. 16 Byte AES                                                                                      |
|                              |           |                            |                                                                                                                       |                                 | 2. Initialize a key policy structure                                                                             | 2. 24 Byte AES                                                                                      |
|                              |           |                            |                                                                                                                       |                                 | 3. Allocate a key slot for a transient key and set the standard fields of a policy structure                     | 3. 32 Byte AES                                                                                      |
|                              |           |                            |                                                                                                                       |                                 | 4. Set the usage policy on a key slot                                                                            | 4. DES 64 bit key                                                                                   |
|                              |           |                            |                                                                                                                       |                                 | 5. Import the key data into the key slot                                                                         | 5. Triple DES 2-Key                                                                                 |
|                              |           |                            |                                                                                                                       |                                 | 6. Set the key for a multipart symmetric encryption operation                                                    | 6. Triple DES 3-Key                                                                                 |
|                              |           |                            |                                                                                                                       |                                 | 7. Generate an IV for a symmetric encryption operation                                                           | 7. AES - large iv buffer                                                                            |
|                              |           |                            |                                                                                                                       |                                 | 8. Check that if generated iv length match the expected length                                                   | 8. DES - large iv buffer                                                                            |
|                              |           |                            |                                                                                                                       |                                 | 9. Check that if generated iv are zero                                                                           |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 10. Generating an IV for a symmetric encryption operation using the same operator should fail                    |                                                                                                     |
|                              |           |                            |                                                                                                                       | PSA_ERROR_BUFFER_TOO_SMALL      |                                                                                                                  | 1. AES - small iv buffer                                                                            |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 2. DES - small iv buffer                                                                            |
|                              | test_c035 | psa_cipher_set_iv          | Set the IV for a symmetric encryption or decryption operation                                                         | PSA_SUCCESS                     | 1. Initialize the PSA crypto library                                                                             | 1. 16 Byte AES                                                                                      |
|                              |           |                            |                                                                                                                       |                                 | 2. Initialize a key policy structure                                                                             | 2. 24 Byte AES                                                                                      |
|                              |           |                            |                                                                                                                       |                                 | 3. Allocate a key slot for a transient key and set the standard fields of a policy structure                     | 3. 32 Byte AES                                                                                      |
|                              |           |                            |                                                                                                                       |                                 | 4. Set the usage policy on a key slot                                                                            | 4. DES 64 bit key                                                                                   |
|                              |           |                            |                                                                                                                       |                                 | 5. Import the key data into the key slot                                                                         | 5. Triple DES 2-Key                                                                                 |
|                              |           |                            |                                                                                                                       |                                 | 6. Set the key for a multipart symmetric encryption/decryption operation                                         | 6. Triple DES 3-Key                                                                                 |
|                              |           |                            |                                                                                                                       |                                 | 7. Set an IV for a symmetric encryption/decryption operation                                                     |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 8. Check that if generated iv length match the expected length                                                   |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 9. Check that if generated iv are zero                                                                           |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 10. Setting an IV for a symmetric encryption/decryption operation using the same operator should fail            |                                                                                                     |
|                              |           |                            |                                                                                                                       | PSA_ERROR_INVALID_ARGUMENT      |                                                                                                                  | 1. AES - small iv buffer 2. DES - small iv buffer 3. AES - large iv buffer 4. DES - large iv buffer |
|                              | test_c036 | psa_cipher_update          | Encrypt or decrypt a message fragment in an active cipher operation                                                   | PSA_SUCCESS                     | 1. Initialize the PSA crypto library                                                                             | 1. AES CBC_NO_PADDING                                                                               |
|                              |           |                            |                                                                                                                       |                                 | 2. Initialize a key policy structure                                                                             | 2. AES CBC_NO_PADDING (Short input)                                                                 |
|                              |           |                            |                                                                                                                       |                                 | 3. Allocate a key slot for a transient key and set the standard fields of a policy structure                     | 3. AES CBC_PKCS7                                                                                    |
|                              |           |                            |                                                                                                                       |                                 | 4. Set the usage policy on a key slot                                                                            | 4. AES CBC_PKCS7 (Short input)                                                                      |
|                              |           |                            |                                                                                                                       |                                 | 5. Import the key data into the key slot                                                                         | 5. AES CTR                                                                                          |
|                              |           |                            |                                                                                                                       |                                 | 6. Set the key for a multipart symmetric encryption operation                                                    | 6. DES CBC (nopad)                                                                                  |
|                              |           |                            |                                                                                                                       |                                 | 7. Set an IV for a symmetric encryption operation                                                                | 7. 2-key 3DE -CBC (nopad)                                                                           |
|                              |           |                            |                                                                                                                       |                                 | 8. Encrypt or decrypt a message fragment in an active cipher operation                                           | 8. 3-key 3DE -CBC (nopad)                                                                           |
|                              |           |                            |                                                                                                                       |                                 | 9. Check if the output length matches the expected length                                                        |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 10. Check if the output data matches the expected data                                                           |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 11. Encrypt or decrypt a message fragment in an invalid cipher operation should fail                             |                                                                                                     |
|                              |           |                            |                                                                                                                       | PSA_ERROR_BAD_STATE             | Encrypt or decrypt a message fragment in an invalid cipher operation should fail                                 | Invalid operation as input                                                                          |
|                              | test_c037 | psa_cipher_finish          | Finish encrypting or decrypting a message in a cipher operation                                                       | PSA_SUCCESS                     | 1. Initialize the PSA crypto library                                                                             | 1. AES CBC_NO_PADDING                                                                               |
|                              |           |                            |                                                                                                                       |                                 | 2. Initialize a key policy structure                                                                             | 2. AES CBC_NO_PADDING (Short input)                                                                 |
|                              |           |                            |                                                                                                                       |                                 | 3. Allocate a key slot for a transient key and set the standard fields of a policy structure                     | 3. AES CBC_PKCS7                                                                                    |
|                              |           |                            |                                                                                                                       |                                 | 4. Set the usage policy on a key slot                                                                            | 4. AES CBC_PKCS7 (Short input)                                                                      |
|                              |           |                            |                                                                                                                       |                                 | 5. Import the key data into the key slot                                                                         | 5. AES CTR                                                                                          |
|                              |           |                            |                                                                                                                       |                                 | 6. Set the key for a multipart symmetric encryption operation                                                    | 6. DES CBC (nopad)                                                                                  |
|                              |           |                            |                                                                                                                       |                                 | 7. Set an IV for a symmetric encryption operation                                                                | 7. 2-key 3DE -CBC (nopad)                                                                           |
|                              |           |                            |                                                                                                                       |                                 | 8. Encrypt or decrypt a message fragment in an active cipher operation                                           | 8. 3-key 3DE -CBC (nopad)                                                                           |
|                              |           |                            |                                                                                                                       |                                 | 9. Finish encrypting or decrypting a message in a cipher operation                                               |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 10. Check if the output length matches the expected length                                                       |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 11. Check if the output data matches the expected data                                                           |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 12. Finish encrypting or decrypting a message using an invalid operation should fail                             |                                                                                                     |
|                              |           |                            |                                                                                                                       | PSA_ERROR_BAD_STATE             | Encrypt or decrypt a message fragment in an invalid cipher operation should fail                                 | Invalid operation as input                                                                          |
|                              | test_c038 | psa_cipher_abort           | Abort a cipher operation                                                                                              | PSA_SUCCESS                     | 1. Initialize the PSA crypto library                                                                             | 1. Encrypt - AES CBC_NO_PADDING                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 2. Initialize a key policy structure                                                                             | 2. Encrypt - AES CBC_PKCS7                                                                          |
|                              |           |                            |                                                                                                                       |                                 | 3. Allocate a key slot for a transient key and set the standard fields of a policy structure                     | 3. Encrypt - AES CTR                                                                                |
|                              |           |                            |                                                                                                                       |                                 | 4. Set the usage policy on a key slot                                                                            | 4. Encrypt - DES CBC (nopad)                                                                        |
|                              |           |                            |                                                                                                                       |                                 | 5. Import the key data into the key slot                                                                         | 5. Encrypt - 2-key 3DE -CBC (nopad)                                                                 |
|                              |           |                            |                                                                                                                       |                                 | 6. Set the key for a multipart symmetric encryption/decryption operation                                         | 6. Encrypt - 3-key 3DE -CBC (nopad)                                                                 |
|                              |           |                            |                                                                                                                       |                                 | 7. Abort a cipher operation                                                                                      | 7. Decrypt - AES CBC_NO_PADDING                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 8. Multiple abort cipher operation should return success                                                         | 8. Decrypt - AES CBC_PKCS7                                                                          |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 9. Decrypt - AES CTR                                                                                |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 10. Decrypt - DES CBC (nopad)                                                                       |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 11. Decrypt - 2-key 3DE -CBC (nopad)                                                                |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 12. Decrypt - 3-key 3DE -CBC (nopad)                                                                |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 13. psa_cipher_update after psa_cipher_abort should fail                                            |
| Asymmetric Cryptography      | test_c039 | psa_asymmetric_encrypt     | Encrypt a short message with a public key                                                                             | PSA_SUCCESS                     | 1. Initialize the PSA crypto library                                                                             | 1. RSA PKCS1V15                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 2. Initialize a key policy structure                                                                             | 2. RSA OAEP SHA256                                                                                  |
|                              |           |                            |                                                                                                                       |                                 | 3. Allocate a key slot for a transient key and set the standard fields of a policy structure                     | 3. RSA OAEP SHA256 with label                                                                       |
|                              |           |                            |                                                                                                                       |                                 | 4. Set the usage policy on a key slot                                                                            | 4. RSA KEYPAIR PKCS1V15                                                                             |
|                              |           |                            |                                                                                                                       |                                 | 5. Import the key data into the key slot                                                                         |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 6. Encrypt a short message with a public key                                                                     |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 7. Check if the output length matches with the expected output length                                            |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 8. Decrypt the cipher text                                                                                       |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 9. Check if the output length matches with the input length                                                      |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 10. Check if the output matches with the given input data                                                        |                                                                                                     |
|                              |           |                            |                                                                                                                       | PSA_ERROR_INVALID_ARGUMENT      |                                                                                                                  | 1. Small output buffer                                                                              |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 2. Invalid algorithm                                                                                |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 3. Invalid key type                                                                                 |
|                              |           |                            |                                                                                                                       | PSA_ERROR_INVALID_HANDLE        |                                                                                                                  | 1. Invalid key slot </br>2. Zero key slot                                                           |
|                              |           |                            |                                                                                                                       | PSA_ERROR_NOT_PERMITTED         |                                                                                                                  | Invalid usage                                                                                       |
|                              |           |                            |                                                                                                                       | PSA_ERROR_EMPTY_SLOT            |                                                                                                                  | Empty key slot                                                                                      |
|                              | test_c040 | psa_asymmetric_decrypt     | Decrypt a short message with a private key                                                                            | PSA_SUCCESS                     | 1. Initialize the PSA crypto library                                                                             | 1. RSA KEYPAIR PKCS1V15                                                                             |
|                              |           |                            |                                                                                                                       |                                 | 2. Initialize a key policy structure                                                                             | 2. RSA KEYPAIR OAEP SHA256                                                                          |
|                              |           |                            |                                                                                                                       |                                 | 3. Allocate a key slot for a transient key and set the standard fields of a policy structure                     | 3. RSA KEYPAIR OAEP SHA256 with label                                                               |
|                              |           |                            |                                                                                                                       |                                 | 4. Set the usage policy on a key slot                                                                            |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 5. Import the key data into the key slot                                                                         |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 6. Decrypt a short message with a private key                                                                    |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 7. Check if the output length matches with the expected length                                                   |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 8. Check if the output matches with the expected data                                                            |                                                                                                     |
|                              |           |                            |                                                                                                                       | PSA_ERROR_INVALID_ARGUMENT      |                                                                                                                  | 1. Invalid key type (RSA public key)                                                                |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 2. Invalid algorithm                                                                                |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 3. Invalid key type (AES Key)                                                                       |
|                              |           |                            |                                                                                                                       | PSA_ERROR_EMPTY_SLOT            |                                                                                                                  | Empty key slot                                                                                      |
|                              |           |                            |                                                                                                                       | PSA_ERROR_NOT_PERMITTED         |                                                                                                                  | Invalid usage                                                                                       |
|                              |           |                            |                                                                                                                       | PSA_ERROR_INVALID_HANDLE        |                                                                                                                  | 1. Invalid key slot </br>2. Zero key slot                                                           |
|                              |           |                            |                                                                                                                       | PSA_ERROR_BUFFER_TOO_SMALL      |                                                                                                                  | Small output buffer                                                                                 |
|                              | test_c041 | psa_asymmetric_sign        | Sign a hash or short message with a private key                                                                       | PSA_SUCCESS                     | 1. Initialize the PSA crypto library                                                                             | 1. RSA KEYPAIR PKCS1V15 RAW                                                                         |
|                              |           |                            |                                                                                                                       |                                 | 2. Initialize a key policy structure                                                                             | 2. RSA KEYPAIR PKCS1V15 SHA-256                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 3. Allocate a key slot for a transient key and set the standard fields of a policy structure                     | 3. ECDSA KEYPAIR SECP256R1 SHA-256                                                                  |
|                              |           |                            |                                                                                                                       |                                 | 4. Set the usage policy on a key slot                                                                            |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 5. Import the key data into the key slot                                                                         |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 6. Sign a hash or short message with a private key                                                               |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 7. Check if the output length matches with the expected length                                                   |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 8. Check if the output matches with the expected data                                                            |                                                                                                     |
|                              |           |                            |                                                                                                                       | PSA_ERROR_INVALID_ARGUMENT      |                                                                                                                  | 1. Invalid key type (RSA public key)                                                                |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 2. Invalid algorithm                                                                                |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 3. Invalid key type (AES Key)                                                                       |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 4. Wrong hash size                                                                                  |
|                              |           |                            |                                                                                                                       | PSA_ERROR_INVALID_HANDLE        |                                                                                                                  | 1. Invalid key slot </br>2. Zero key slot                                                           |
|                              |           |                            |                                                                                                                       | PSA_ERROR_EMPTY_SLOT            |                                                                                                                  | Empty key slot                                                                                      |
|                              |           |                            |                                                                                                                       | PSA_ERROR_NOT_PERMITTED         |                                                                                                                  | Invalid usage                                                                                       |
|                              |           |                            |                                                                                                                       | PSA_ERROR_BUFFER_TOO_SMALL      |                                                                                                                  | Small output buffer                                                                                 |
|                              | test_c042 | psa_asymmetric_verify      | Verify the signature a hash or short message using a public key                                                       | PSA_SUCCESS                     | 1. Initialize the PSA crypto library                                                                             | 1. RSA KEYPAIR PKCS1V15 RAW                                                                         |
|                              |           |                            |                                                                                                                       |                                 | 2. Initialize a key policy structure                                                                             | 2. RSA KEYPAIR PKCS1V15 SHA-256                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 3. Allocate a key slot for a transient key and set the standard fields of a policy structure                     | 3. ECDSA KEYPAIR SECP256R1 SHA-256                                                                  |
|                              |           |                            |                                                                                                                       |                                 | 4. Set the key data based on key type                                                                            | 4. RSA public key                                                                                   |
|                              |           |                            |                                                                                                                       |                                 | 5. Set the usage policy on a key slot                                                                            | 5. EC public key                                                                                    |
|                              |           |                            |                                                                                                                       |                                 | 6. Import the key data into the key slot                                                                         |                                                                                                     |
|                              |           |                            |                                                                                                                       |                                 | 7. Verify the signature a hash or short message using a public key                                               |                                                                                                     |
|                              |           |                            |                                                                                                                       | PSA_ERROR_INVALID_ARGUMENT      |                                                                                                                  | 1. Invalid algorithm                                                                                |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | 2. Wrong hash size                                                                                  |
|                              |           |                            |                                                                                                                       | PSA_ERROR_INVALID_HANDLE        |                                                                                                                  | 1. Invalid key slot </br>2. Zero key slot                                                           |
|                              |           |                            |                                                                                                                       | PSA_ERROR_INVALID_SIGNATURE     |                                                                                                                  | Wrong signature size                                                                                |
|                              |           |                            |                                                                                                                       |                                 |                                                                                                                  | Wrong signature                                                                                     |
|                              |           |                            |                                                                                                                       | PSA_ERROR_EMPTY_SLOT            |                                                                                                                  | Empty key slot                                                                                      |
|                              |           |                            |                                                                                                                       | PSA_ERROR_NOT_PERMITTED         |                                                                                                                  | Invalid usage                                                                                       |
|                              |           |                            |                                                                                                                       | PSA_ERROR_NOT_SUPPORTED         |                                                                                                                  | Invalid key type (AES Key)                                                                          |
|                              |           |                            |                                                                                                                       | PSA_ERROR_BUFFER_TOO_SMALL      |                                                                                                                  | Small output buffer                                                                                 |

## License
Arm PSA test suite is distributed under Apache v2.0 License.

--------------

*Copyright (c) 2018-2019, Arm Limited and Contributors. All rights reserved.*
